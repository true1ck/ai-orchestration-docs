<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Intelligence Platform ‚Äî Agent Build Plan</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;700;800&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a0f;
            --surface: #12121a;
            --surface2: #1a1a26;
            --border: #2a2a40;
            --accent: #5b4fff;
            --accent2: #ff4f8b;
            --accent3: #4fffd4;
            --accent4: #ffc34f;
            --accent5: #78ff64;
            --text: #e8e8f0;
            --muted: #6b6b8a;
            --glow: rgba(91, 79, 255, 0.25);
            --glow2: rgba(79, 255, 212, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Syne', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 999;
            opacity: 0.4;
        }

        .grid-bg {
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(rgba(91, 79, 255, 0.04) 1px, transparent 1px),
                linear-gradient(90deg, rgba(91, 79, 255, 0.04) 1px, transparent 1px);
            background-size: 60px 60px;
            animation: gridMove 20s linear infinite;
            z-index: 0;
        }

        @keyframes gridMove {
            0% {
                background-position: 0 0
            }

            100% {
                background-position: 60px 60px
            }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        /* ‚îÄ‚îÄ BACK NAV ‚îÄ‚îÄ */
        .back-nav {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(10, 10, 15, 0.92);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
            padding: 12px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .back-nav-left {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            color: var(--muted);
            letter-spacing: .5px;
        }

        .back-link {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--accent);
            text-decoration: none;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            letter-spacing: 1px;
            padding: 5px 12px;
            border: 1px solid rgba(91, 79, 255, 0.25);
            border-radius: 5px;
            background: rgba(91, 79, 255, 0.06);
            transition: all 0.2s;
        }

        .back-link:hover {
            background: rgba(91, 79, 255, 0.15);
            border-color: rgba(91, 79, 255, 0.5);
        }

        /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
        .header {
            text-align: center;
            margin-bottom: 64px;
            animation: fadeUp 0.6s ease both;
        }

        .header .tag {
            display: inline-block;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            color: var(--accent);
            border: 1px solid var(--accent);
            padding: 4px 12px;
            border-radius: 2px;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 20px;
            background: rgba(91, 79, 255, 0.08);
        }

        .header h1 {
            font-size: clamp(32px, 5vw, 56px);
            font-weight: 800;
            line-height: 1.05;
            letter-spacing: -1px;
            margin-bottom: 12px;
        }

        .header h1 span {
            color: var(--accent3);
        }

        .header p {
            color: var(--muted);
            font-size: 14px;
            font-family: 'Space Mono', monospace;
            line-height: 1.7;
        }

        /* ‚îÄ‚îÄ SECTION TITLES ‚îÄ‚îÄ */
        .section-title {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            color: var(--accent3);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 28px;
            margin-top: 56px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, var(--border), transparent);
        }

        .section-title:first-of-type {
            margin-top: 0;
        }

        /* ‚îÄ‚îÄ VISION STATEMENT ‚îÄ‚îÄ */
        .vision {
            background: var(--surface);
            border: 1px solid rgba(79, 255, 212, 0.3);
            border-radius: 12px;
            padding: 36px 40px;
            margin-bottom: 48px;
            position: relative;
            overflow: hidden;
            animation: fadeUp 0.6s 0.1s ease both;
            box-shadow: 0 0 60px rgba(79, 255, 212, 0.05);
        }

        .vision::before {
            content: '"';
            font-size: 200px;
            color: rgba(79, 255, 212, 0.04);
            position: absolute;
            top: -40px;
            left: 20px;
            line-height: 1;
            font-weight: 800;
        }

        .vision p {
            font-size: clamp(15px, 2vw, 20px);
            line-height: 1.7;
            font-style: italic;
            position: relative;
            z-index: 1;
            color: var(--text);
        }

        .vision p span {
            color: var(--accent3);
            font-style: normal;
            font-weight: 700;
        }

        .vision-tags {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .vtag {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 1px;
            padding: 4px 10px;
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--muted);
        }

        /* ‚îÄ‚îÄ ARCH DIAGRAM ‚îÄ‚îÄ */
        .arch-diagram {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 40px 32px;
            margin-bottom: 48px;
            animation: fadeUp 0.6s 0.1s ease both;
            position: relative;
            overflow: hidden;
        }

        .arch-diagram::before {
            content: '';
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            width: 400px;
            height: 200px;
            background: radial-gradient(ellipse, rgba(91, 79, 255, 0.12) 0%, transparent 70%);
            pointer-events: none;
        }

        .flow {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0;
        }

        .flow-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            width: 100%;
        }

        .node {
            border-radius: 10px;
            padding: 16px 24px;
            text-align: center;
            position: relative;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: default;
        }

        .node:hover {
            transform: translateY(-3px);
        }

        .node-label {
            font-size: 11px;
            font-family: 'Space Mono', monospace;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 4px;
            opacity: .7;
        }

        .node-title {
            font-size: 15px;
            font-weight: 700;
            white-space: nowrap;
        }

        .node-sub {
            font-size: 10px;
            font-family: 'Space Mono', monospace;
            margin-top: 4px;
            opacity: .5;
        }

        .node-desc {
            font-size: 10px;
            color: var(--muted);
            margin-top: 10px;
            line-height: 1.4;
            max-width: 170px;
            margin-left: auto;
            margin-right: auto;
            white-space: normal;
        }

        .node-tool {
            font-family: 'Space Mono', monospace;
            font-size: 8.5px;
            background: rgba(255, 255, 255, 0.05);
            padding: 4px 6px;
            border-radius: 4px;
            margin-top: 10px;
            display: inline-block;
            color: var(--accent3);
            letter-spacing: 0.5px;
        }

        .node-user {
            background: rgba(255, 79, 139, 0.12);
            border: 1.5px solid rgba(255, 79, 139, 0.5);
        }

        .node-user .node-title {
            color: var(--accent2);
        }

        .node-orchestrator {
            background: rgba(91, 79, 255, 0.15);
            border: 2px solid var(--accent);
            box-shadow: 0 0 40px rgba(91, 79, 255, 0.2);
            min-width: 260px;
            padding: 20px 32px;
            animation: pulse-ring 3s ease-in-out infinite;
        }

        .node-orchestrator .node-title {
            color: #a89fff;
            font-size: 18px;
        }

        .node-agent {
            background: rgba(255, 195, 79, 0.08);
            border: 1.5px solid rgba(255, 195, 79, 0.3);
            min-width: 160px;
        }

        .node-agent .node-title {
            color: var(--accent4);
            font-size: 13px;
        }

        .node-agent:hover {
            box-shadow: 0 6px 24px rgba(255, 195, 79, 0.15);
        }

        .node-output {
            background: rgba(120, 255, 100, 0.07);
            border: 1.5px solid rgba(120, 255, 100, 0.3);
        }

        .node-output .node-title {
            color: var(--accent5);
            font-size: 13px;
        }

        .node-input-src {
            background: rgba(79, 255, 212, 0.07);
            border: 1.5px solid rgba(79, 255, 212, 0.3);
            min-width: 140px;
        }

        .node-input-src .node-title {
            color: var(--accent3);
            font-size: 13px;
        }

        @keyframes pulse-ring {
            0% {
                box-shadow: 0 0 0 0 rgba(91, 79, 255, 0.4), 0 0 40px rgba(91, 79, 255, 0.2);
            }

            70% {
                box-shadow: 0 0 0 12px rgba(91, 79, 255, 0), 0 0 40px rgba(91, 79, 255, 0.2);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(91, 79, 255, 0), 0 0 40px rgba(91, 79, 255, 0.2);
            }
        }

        .connector-v {
            width: 2px;
            min-height: 28px;
            background: linear-gradient(180deg, rgba(91, 79, 255, 0.6), rgba(79, 255, 212, 0.4));
            margin: 0 auto;
            position: relative;
        }

        .connector-v.down::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top: 6px solid rgba(79, 255, 212, 0.6);
        }

        .bi-line {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            color: var(--muted);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .bi-line::before,
        .bi-line::after {
            content: '';
            width: 40px;
            height: 1px;
            background: rgba(91, 79, 255, 0.4);
        }

        .mcp-box {
            background: rgba(79, 255, 212, 0.04);
            border: 1px dashed rgba(79, 255, 212, 0.22);
            border-radius: 12px;
            padding: 20px 24px;
            width: 100%;
            max-width: 900px;
        }

        .mcp-label {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            color: var(--accent3);
            letter-spacing: 2px;
            text-transform: uppercase;
            text-align: center;
            margin-bottom: 16px;
            opacity: .7;
        }

        .agents-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 8px 0;
        }

        /* ‚îÄ‚îÄ EXEC STEPS ‚îÄ‚îÄ */
        .flow-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 2px;
            margin-bottom: 48px;
            animation: fadeUp 0.6s 0.2s ease both;
            border-radius: 10px;
            overflow: hidden;
        }

        .step {
            background: var(--surface);
            padding: 20px;
            position: relative;
            transition: background 0.2s;
        }

        .step:hover {
            background: var(--surface2);
        }

        .step-num {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .step-title {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .step-text {
            font-size: 12px;
            color: var(--muted);
            line-height: 1.5;
        }

        /* ‚îÄ‚îÄ AGENT CARDS ‚îÄ‚îÄ */
        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin-bottom: 48px;
            animation: fadeUp 0.6s 0.2s ease both;
        }

        .agent-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 24px;
            transition: border-color 0.2s, transform 0.2s;
            position: relative;
            overflow: hidden;
        }

        .agent-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent);
        }

        .agent-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
        }

        .agent-card.orchestrator::before {
            background: linear-gradient(90deg, var(--accent), #9b4fff);
        }

        .agent-card.planner::before {
            background: linear-gradient(90deg, var(--accent3), #4f9fff);
        }

        .agent-card.prioritizer::before {
            background: linear-gradient(90deg, var(--accent4), #ff7f4f);
        }

        .agent-card.reviewer::before {
            background: linear-gradient(90deg, var(--accent2), #ff4f4f);
        }

        .agent-card.summarizer::before {
            background: linear-gradient(90deg, var(--accent5), var(--accent3));
        }

        .agent-card.transcriber::before {
            background: linear-gradient(90deg, #f87171, #fb923c);
        }

        .agent-card.extractor::before {
            background: linear-gradient(90deg, #818cf8, #a78bfa);
        }

        .agent-card.analyst::before {
            background: linear-gradient(90deg, var(--accent4), var(--accent5));
        }

        .agent-card.aggregator::before {
            background: linear-gradient(90deg, var(--accent3), var(--accent));
        }

        .agent-badge {
            display: inline-block;
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 2px;
            padding: 3px 10px;
            border-radius: 3px;
            text-transform: uppercase;
            margin-bottom: 14px;
        }

        .orchestrator .agent-badge {
            background: rgba(91, 79, 255, 0.15);
            color: #a89fff;
            border: 1px solid rgba(91, 79, 255, 0.3);
        }

        .planner .agent-badge {
            background: rgba(79, 255, 212, 0.1);
            color: var(--accent3);
            border: 1px solid rgba(79, 255, 212, 0.25);
        }

        .prioritizer .agent-badge {
            background: rgba(255, 195, 79, 0.1);
            color: var(--accent4);
            border: 1px solid rgba(255, 195, 79, 0.25);
        }

        .reviewer .agent-badge {
            background: rgba(255, 79, 139, 0.1);
            color: var(--accent2);
            border: 1px solid rgba(255, 79, 139, 0.25);
        }

        .summarizer .agent-badge {
            background: rgba(120, 255, 100, 0.1);
            color: var(--accent5);
            border: 1px solid rgba(120, 255, 100, 0.25);
        }

        .transcriber .agent-badge {
            background: rgba(248, 113, 113, 0.1);
            color: #f87171;
            border: 1px solid rgba(248, 113, 113, 0.25);
        }

        .extractor .agent-badge {
            background: rgba(129, 140, 248, 0.1);
            color: #818cf8;
            border: 1px solid rgba(129, 140, 248, 0.25);
        }

        .analyst .agent-badge {
            background: rgba(255, 195, 79, 0.1);
            color: var(--accent4);
            border: 1px solid rgba(255, 195, 79, 0.25);
        }

        .aggregator .agent-badge {
            background: rgba(79, 255, 212, 0.1);
            color: var(--accent3);
            border: 1px solid rgba(79, 255, 212, 0.25);
        }

        .agent-card h3 {
            font-size: 17px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .agent-card .description {
            font-size: 13px;
            color: var(--muted);
            line-height: 1.65;
            margin-bottom: 16px;
        }

        .agent-card .tools-label {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            color: var(--muted);
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .tools-list {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }

        .tool-chip {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 3px;
            background: var(--surface2);
            border: 1px solid var(--border);
            color: var(--text);
        }

        .kv-row {
            display: flex;
            gap: 8px;
            align-items: flex-start;
            margin-bottom: 5px;
        }

        .kv-key {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--muted);
            width: 72px;
            flex-shrink: 0;
            padding-top: 1px;
        }

        .kv-val {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            color: var(--text);
            opacity: .8;
        }

        .resp-list {
            list-style: none;
            padding: 0;
        }

        .resp-list li {
            font-size: 12px;
            color: var(--muted);
            padding: 4px 0;
            padding-left: 14px;
            position: relative;
            line-height: 1.5;
        }

        .resp-list li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: var(--accent3);
            font-size: 10px;
            top: 5px;
        }

        /* ‚îÄ‚îÄ CODE TABS ‚îÄ‚îÄ */
        .code-section {
            margin-bottom: 48px;
            animation: fadeUp 0.6s 0.3s ease both;
        }

        .tabs {
            display: flex;
            gap: 2px;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .tab {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            padding: 10px 16px;
            cursor: pointer;
            color: var(--muted);
            border-radius: 6px 6px 0 0;
            border: 1px solid transparent;
            border-bottom: none;
            transition: all 0.15s;
            background: transparent;
            outline: none;
            letter-spacing: .5px;
        }

        .tab.active {
            color: var(--text);
            background: var(--surface2);
            border-color: var(--border);
            border-bottom-color: var(--surface2);
            margin-bottom: -1px;
        }

        .tab:hover:not(.active) {
            color: var(--text);
            background: rgba(255, 255, 255, 0.03);
        }

        .code-block {
            background: var(--surface2);
            border: 1px solid var(--border);
            border-top: none;
            border-radius: 0 0 8px 8px;
            padding: 28px;
            display: none;
            position: relative;
        }

        .code-block.active {
            display: block;
        }

        .code-block pre {
            font-family: 'Space Mono', monospace;
            font-size: 11.5px;
            line-height: 1.75;
            color: #c9d1d9;
            overflow-x: auto;
            white-space: pre;
        }

        .k {
            color: #ff79c6;
        }

        .s {
            color: #f1fa8c;
        }

        .c {
            color: #6272a4;
        }

        .n {
            color: #8be9fd;
        }

        .v {
            color: #bd93f9;
        }

        .b {
            color: #50fa7b;
        }

        .p {
            color: #ff6e6e;
        }

        .copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            padding: 5px 12px;
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--muted);
            border-radius: 4px;
            cursor: pointer;
            letter-spacing: 1px;
            transition: all 0.15s;
        }

        .copy-btn:hover {
            color: var(--text);
            border-color: var(--accent);
        }

        /* ‚îÄ‚îÄ COST TABLE ‚îÄ‚îÄ */
        .cost-table {
            width: 100%;
            border-collapse: collapse;
            animation: fadeUp 0.6s 0.35s ease both;
            font-size: 13px;
            margin-bottom: 48px;
        }

        .cost-table th {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--muted);
            border-bottom: 1px solid var(--border);
            padding: 10px 14px;
            text-align: left;
        }

        .cost-table td {
            padding: 12px 14px;
            border-bottom: 1px solid rgba(42, 42, 64, 0.5);
            vertical-align: top;
            line-height: 1.5;
            color: var(--muted);
            font-size: 12px;
        }

        .cost-table tr:hover td {
            background: rgba(91, 79, 255, 0.04);
        }

        .cost-table td:first-child {
            color: var(--text);
            font-weight: 600;
            font-size: 13px;
        }

        .cost-table td.mono {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
        }

        .badge-pill {
            display: inline-block;
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 30px;
            margin: 1px;
        }

        .pill-r {
            background: rgba(255, 79, 139, 0.12);
            color: var(--accent2);
        }

        .pill-g {
            background: rgba(120, 255, 100, 0.12);
            color: var(--accent5);
        }

        .pill-a {
            background: rgba(255, 195, 79, 0.12);
            color: var(--accent4);
        }

        .pill-t {
            background: rgba(79, 255, 212, 0.12);
            color: var(--accent3);
        }

        .pill-p {
            background: rgba(91, 79, 255, 0.12);
            color: #a89fff;
        }

        .pill-k {
            background: rgba(255, 255, 255, 0.06);
            color: var(--muted);
        }

        /* ‚îÄ‚îÄ COST SUMMARY CARDS ‚îÄ‚îÄ */
        .cost-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 48px;
        }

        .cost-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.15s;
        }

        .cost-card:hover {
            transform: translateY(-3px);
        }

        .cost-label {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--muted);
            margin-bottom: 8px;
        }

        .cost-val {
            font-size: 26px;
            font-weight: 800;
            letter-spacing: -1px;
            color: var(--text);
        }

        .cost-unit {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            color: var(--muted);
            margin-top: 4px;
        }

        .cost-note {
            font-size: 12px;
            color: var(--muted);
            margin-top: 10px;
            line-height: 1.5;
        }

        /* ‚îÄ‚îÄ ROADMAP ‚îÄ‚îÄ */
        .roadmap {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 2px;
            margin-bottom: 48px;
            border-radius: 10px;
            overflow: hidden;
        }

        .phase {
            background: var(--surface);
            padding: 24px;
            transition: background 0.2s;
        }

        .phase:hover {
            background: var(--surface2);
        }

        .phase-label {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            color: var(--accent);
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .phase h3 {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .phase ul {
            list-style: none;
        }

        .phase ul li {
            font-size: 12px;
            color: var(--muted);
            padding: 5px 0;
            padding-left: 16px;
            position: relative;
            line-height: 1.5;
            border-bottom: 1px solid rgba(42, 42, 64, 0.4);
        }

        .phase ul li:last-child {
            border-bottom: none;
        }

        .phase ul li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: var(--accent3);
            font-size: 10px;
            top: 7px;
        }

        /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
        .footer {
            margin-top: 64px;
            padding-top: 28px;
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 16px;
        }

        .footer-left,
        .footer-right {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            color: var(--muted);
            letter-spacing: .5px;
        }

        .live-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            background: var(--accent3);
            border-radius: 50%;
            animation: blink 2s ease-in-out infinite;
            vertical-align: middle;
            margin-right: 6px;
        }

        /* ‚îÄ‚îÄ THEME TOGGLE ‚îÄ‚îÄ */
        #theme-toggle {
            position: fixed;
            bottom: 28px;
            right: 28px;
            z-index: 9999;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text);
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        #theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 28px rgba(0, 0, 0, 0.3);
        }

        /* ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ */
        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(20px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1
            }

            50% {
                opacity: 0.2
            }
        }

        /* ‚îÄ‚îÄ LIGHT MODE ‚îÄ‚îÄ */
        [data-theme="light"] {
            --bg: #f6f8fa;
            --surface: #fff;
            --surface2: #edf0f4;
            --text: #0d1117;
            --muted: #4b5563;
            --border: rgba(0, 0, 0, 0.12);
            --accent: #5b4fff;
            --accent2: #e11d68;
            --accent3: #0891b2;
            --accent4: #b45309;
            --accent5: #16a34a;
        }

        [data-theme="light"] body {
            background: var(--bg);
            color: var(--text);
        }

        [data-theme="light"] body::before {
            background-image: linear-gradient(rgba(0, 0, 0, 0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
        }

        [data-theme="light"] .back-nav {
            background: rgba(246, 248, 250, 0.95) !important;
            border-color: rgba(0, 0, 0, 0.12) !important;
        }

        [data-theme="light"] .agent-card,
        .cost-card,
        .phase,
        .step,
        .arch-diagram {
            background: var(--surface) !important;
            border-color: rgba(0, 0, 0, 0.14) !important;
        }

        [data-theme="light"] pre {
            background: #1e2030 !important;
            color: #cdd6f4 !important;
        }

        [data-theme="light"] .code-block {
            background: #1e2030 !important;
            border-color: rgba(255, 255, 255, 0.06) !important;
        }

        [data-theme="light"] .cost-table td,
        .cost-table th {
            border-color: rgba(0, 0, 0, 0.1) !important;
            color: var(--muted) !important;
        }

        [data-theme="light"] .cost-table td:first-child {
            color: var(--text) !important;
        }

        /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
        @media (max-width:768px) {
            .agents-grid {
                grid-template-columns: 1fr;
            }

            .cost-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .roadmap {
                grid-template-columns: 1fr;
            }

            .flow-steps {
                grid-template-columns: repeat(2, 1fr);
            }

            .cost-table {
                display: block;
                overflow-x: auto;
            }
        }

        /* ‚îÄ‚îÄ TASK BANNERS ‚îÄ‚îÄ */
        .task-banner {
            display: flex;
            gap: 14px;
            align-items: flex-start;
            border-radius: 8px;
            padding: 16px 20px;
            margin-bottom: 28px;
            font-size: 13px;
            color: var(--muted);
            line-height: 1.6;
            border-left: 4px solid;
        }

        .task-banner.task-a {
            background: rgba(91, 79, 255, 0.07);
            border-color: var(--accent);
        }

        .task-banner.task-b {
            background: rgba(79, 255, 212, 0.06);
            border-color: var(--accent3);
        }

        .task-banner.task-c {
            background: rgba(255, 195, 79, 0.06);
            border-color: var(--accent4);
        }

        .task-tag {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 2px;
            text-transform: uppercase;
            white-space: nowrap;
            padding: 3px 10px;
            border-radius: 3px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .task-a .task-tag {
            background: rgba(91, 79, 255, 0.2);
            color: #a89fff;
        }

        .task-b .task-tag {
            background: rgba(79, 255, 212, 0.2);
            color: var(--accent3);
        }

        .task-c .task-tag {
            background: rgba(255, 195, 79, 0.2);
            color: var(--accent4);
        }

        /* ‚îÄ‚îÄ MCP TOPOLOGY ‚îÄ‚îÄ */
        .mcp-topology {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .topo-orchestrator {
            background: rgba(91, 79, 255, 0.12);
            border: 2px solid var(--accent);
            border-radius: 10px;
            padding: 16px 32px;
            text-align: center;
            animation: pulse-ring 3s ease-in-out infinite;
            min-width: 360px;
        }

        .topo-label {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            color: var(--muted);
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 6px;
        }

        .topo-name {
            font-size: 14px;
            font-weight: 700;
            color: #a89fff;
        }

        .topo-arrows {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            color: var(--muted);
            letter-spacing: 1px;
        }

        .topo-grid {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            padding: 16px;
            border: 1px dashed rgba(79, 255, 212, 0.2);
            border-radius: 10px;
            background: rgba(79, 255, 212, 0.03);
            width: 100%;
        }

        .topo-server {
            border-radius: 8px;
            padding: 14px 16px;
            text-align: center;
            min-width: 150px;
            position: relative;
            border: 1px solid;
        }

        .topo-server-port {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            letter-spacing: 1px;
            position: absolute;
            top: 6px;
            right: 8px;
            opacity: .6;
        }

        .topo-server-name {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 6px;
            margin-top: 4px;
        }

        .topo-server-tool {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            padding: 3px 6px;
            border-radius: 3px;
            display: inline-block;
            margin-bottom: 6px;
        }

        .topo-server-tech {
            font-size: 10px;
            color: var(--muted);
        }

        .s-media {
            background: rgba(248, 113, 113, 0.07);
            border-color: rgba(248, 113, 113, 0.3);
        }

        .s-media .topo-server-name {
            color: #f87171;
        }

        .s-media .topo-server-tool {
            background: rgba(248, 113, 113, 0.1);
            color: #f87171;
        }

        .s-doc {
            background: rgba(129, 140, 248, 0.07);
            border-color: rgba(129, 140, 248, 0.3);
        }

        .s-doc .topo-server-name {
            color: #818cf8;
        }

        .s-doc .topo-server-tool {
            background: rgba(129, 140, 248, 0.1);
            color: #818cf8;
        }

        .s-web {
            background: rgba(79, 255, 212, 0.06);
            border-color: rgba(79, 255, 212, 0.25);
        }

        .s-web .topo-server-name {
            color: var(--accent3);
        }

        .s-web .topo-server-tool {
            background: rgba(79, 255, 212, 0.1);
            color: var(--accent3);
        }

        .s-analysis {
            background: rgba(255, 195, 79, 0.06);
            border-color: rgba(255, 195, 79, 0.25);
        }

        .s-analysis .topo-server-name {
            color: var(--accent4);
        }

        .s-analysis .topo-server-tool {
            background: rgba(255, 195, 79, 0.1);
            color: var(--accent4);
        }

        .s-agg {
            background: rgba(120, 255, 100, 0.06);
            border-color: rgba(120, 255, 100, 0.25);
        }

        .s-agg .topo-server-name {
            color: var(--accent5);
        }

        .s-agg .topo-server-tool {
            background: rgba(120, 255, 100, 0.1);
            color: var(--accent5);
        }

        .topo-db {
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            letter-spacing: 1px;
            padding: 12px 24px;
            border: 1px solid rgba(79, 255, 212, 0.3);
            border-radius: 8px;
            background: rgba(79, 255, 212, 0.05);
            color: var(--accent3);
        }

        /* ‚îÄ‚îÄ DB SCHEMA GRID ‚îÄ‚îÄ */
        .db-schema-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 12px;
            margin-bottom: 32px;
        }

        .db-table {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            font-size: 12px;
        }

        .db-table-header {
            background: rgba(91, 79, 255, 0.12);
            border-bottom: 1px solid var(--border);
            padding: 10px 14px;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            font-weight: 700;
            color: #a89fff;
            letter-spacing: 1px;
        }

        .db-col {
            padding: 6px 14px;
            border-bottom: 1px solid rgba(42, 42, 64, 0.4);
            color: var(--muted);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .db-col:last-child {
            border-bottom: none;
        }

        .db-pk {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            padding: 2px 5px;
            border-radius: 3px;
            background: rgba(255, 195, 79, 0.15);
            color: var(--accent4);
            flex-shrink: 0;
            letter-spacing: 0.5px;
        }

        .db-fk {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            padding: 2px 5px;
            border-radius: 3px;
            background: rgba(255, 79, 139, 0.12);
            color: var(--accent2);
            flex-shrink: 0;
            letter-spacing: 0.5px;
        }

        .db-col-type {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            padding: 2px 5px;
            border-radius: 3px;
            background: rgba(79, 255, 212, 0.08);
            color: var(--accent3);
            flex-shrink: 0;
        }
    </style>
</head>

<body>
    <div class="grid-bg"></div>
    <nav class="back-nav">
        <div class="back-nav-left">
            <span>AI_ORCH / DOCS</span>
            <span style="color:#484f6a">/</span>
            <span>Media Intelligence Platform ‚Äî Agent Build Plan</span>
        </div>
        <a href="index.html" class="back-link">‚Üê Back to Hub</a>
    </nav>

    <div class="container">

        <!-- HEADER -->
        <div class="header">
            <div class="tag">LivingAI Team ‚Äî Build Plan v1.0</div>
            <h1>Media Intelligence<br><span>Agent Plan</span></h1>
            <p>// architecture-first ¬∑ agent-by-agent ¬∑ token-costed ¬∑ prompt-defined<br>
                // inputs: zip (react dashboard) ¬∑ news PDFs ¬∑ youtube videos ¬∑ web scrape data</p>
        </div>

        <!-- VISION -->
        <div class="vision">
            <p>
                Following the <span>MCP Multi-Agent Orchestrator architecture</span> defined in Doc.html,
                this plan describes how a swarm of specialist agents ‚Äî each exposed as an MCP tool ‚Äî will
                autonomously ingest a mixed-media payload containing a <span>React frontend ZIP</span>,
                <span>newspaper PDFs</span>, <span>YouTube news videos</span>, and <span>live web-scraped data</span>,
                and surface a unified, real-time intelligence dashboard with zero manual triage.
            </p>
            <div class="vision-tags">
                <span class="vtag">MCP ORCHESTRATION</span>
                <span class="vtag">REACT FRONTEND (ZIP)</span>
                <span class="vtag">NEWS PDF EXTRACTION</span>
                <span class="vtag">YOUTUBE TRANSCRIPTION</span>
                <span class="vtag">WEB SCRAPE INGESTION</span>
                <span class="vtag">PARALLEL AGENT SWARM</span>
                <span class="vtag">LIVE DASHBOARD</span>
                <span class="vtag">CLAUDE SONNET</span>
            </div>
        </div>

        <!-- 01 ARCHITECTURE -->
        <div class="section-title" style="margin-top:0;">01 ‚Äî System Architecture Flow</div>
        <div class="arch-diagram">
            <div class="flow">

                <!-- Inputs -->
                <div class="flow-row">
                    <div class="node node-input-src">
                        <div class="node-label">Source A</div>
                        <div class="node-title">üì¶ ZIP File</div>
                        <div class="node-sub">React frontend dashboard</div>
                    </div>
                    <div class="node node-input-src">
                        <div class="node-label">Source B</div>
                        <div class="node-title">üì∞ News PDFs</div>
                        <div class="node-sub">newspaper articles / reports</div>
                    </div>
                    <div class="node node-input-src">
                        <div class="node-label">Source C</div>
                        <div class="node-title">üé¨ YouTube</div>
                        <div class="node-sub">news video URLs</div>
                    </div>
                    <div class="node node-input-src">
                        <div class="node-label">Source D</div>
                        <div class="node-title">üåê Web Scrape</div>
                        <div class="node-sub">live article data</div>
                    </div>
                </div>

                <div class="connector-v down" style="height:32px;"></div>
                <div class="bi-line">multi-source payload ‚Üí upload API</div>
                <div class="connector-v down" style="height:12px;"></div>

                <!-- Orchestrator -->
                <div class="flow-row">
                    <div class="node node-orchestrator">
                        <div class="node-label">1 Central Brain</div>
                        <div class="node-title">üß† Orchestrator Agent</div>
                        <div class="node-sub">claude-sonnet-4-6</div>
                        <div class="node-desc" style="max-width:280px; color: #a89fff;">Unpacks payload, detects MIME
                            types, builds execution DAG, and orchestrates the 5 downstream tool calls.</div>
                    </div>
                </div>

                <div class="connector-v down" style="height:32px;"></div>
                <div class="bi-line">tool_use calls via MCP protocol</div>
                <div class="connector-v down" style="height:12px;"></div>

                <!-- MCP Agent Swarm -->
                <div class="mcp-box">
                    <div class="mcp-label">‚ö° MCP Server ‚Äî Parallel Agent Swarm (asyncio.gather)</div>
                    <div class="agents-row">
                        <div class="node node-agent">
                            <div class="node-label">Agent 1 (Parallel)</div>
                            <div class="node-title">üéô Transcriber</div>
                            <div class="node-sub">youtube ‚Üí transcript</div>
                            <div class="node-desc">Runs yt-dlp & Whisper STT. Cleans text & extracts key quotes.</div>
                            <div class="node-tool">mcp: transcribe_video</div>
                        </div>
                        <div class="node node-agent">
                            <div class="node-label">Agent 2 (Parallel)</div>
                            <div class="node-title">üìÑ Doc Extractor</div>
                            <div class="node-sub">PDF ‚Üí text + entities</div>
                            <div class="node-desc">Parses PyMuPDF text. LLM extracts entities, dates & summary.</div>
                            <div class="node-tool">mcp: parse_pdf</div>
                        </div>
                        <div class="node node-agent">
                            <div class="node-label">Agent 3 (Parallel)</div>
                            <div class="node-title">üåê Scrape Parser</div>
                            <div class="node-sub">web ‚Üí json</div>
                            <div class="node-desc">Cleans boilerplate HTML. Normalizes to unified schema.</div>
                            <div class="node-tool">mcp: parse_web</div>
                        </div>
                        <div class="node node-agent">
                            <div class="node-label">Agent 4 (Seq to Text)</div>
                            <div class="node-title">üìä Analyst</div>
                            <div class="node-sub">sentiment + taxonomy</div>
                            <div class="node-desc">Scores sentiment, detects bias, and assigns taxonomy tags.</div>
                            <div class="node-tool">mcp: analyze_content</div>
                        </div>
                        <div class="node node-agent">
                            <div class="node-label">Agent 5 (Final Sync)</div>
                            <div class="node-title">üîó Aggregator</div>
                            <div class="node-sub">cross-source brief</div>
                            <div class="node-desc">Finds entity intersections. Generates final intel briefing.</div>
                            <div class="node-tool">mcp: aggregate_intel</div>
                        </div>
                    </div>
                </div>

                <div class="connector-v down" style="height:32px;"></div>
                <div class="bi-line">structured JSON stream ‚Üí FastAPI ‚Üí WebSocket ‚Üí React UI</div>
                <div class="connector-v down" style="height:12px;"></div>

                <!-- Output -->
                <div class="flow-row">
                    <div class="node node-output">
                        <div class="node-label">Output</div>
                        <div class="node-title">‚úÖ Live Intelligence Dashboard</div>
                        <div class="node-sub">React frontend (ZIP) ¬∑ auto-populated ¬∑ real-time cards</div>
                    </div>
                </div>

            </div>
        </div>

        <!-- 02 EXECUTION STEPS -->
        <div class="section-title">02 ‚Äî Execution Flow (Step by Step)</div>
        <div class="flow-steps">
            <div class="step">
                <div class="step-num">STEP 01</div>
                <div class="step-title">Input Upload</div>
                <div class="step-text">User uploads ZIP (React app), PDFs, YouTube URLs, and web scrape data via FastAPI
                    multipart endpoint</div>
            </div>
            <div class="step">
                <div class="step-num">STEP 02</div>
                <div class="step-title">Orchestrator Triage</div>
                <div class="step-text">Orchestrator detects MIME types, classifies each input, builds a DAG, and decides
                    which MCP tool calls to fire</div>
            </div>
            <div class="step">
                <div class="step-num">STEP 03</div>
                <div class="step-title">Parallel Dispatch</div>
                <div class="step-text">asyncio.gather fires Tools 1‚Äì4 simultaneously: Transcriber on YouTube, Doc
                    Extractor on PDFs, Scrape Parser on web data</div>
            </div>
            <div class="step">
                <div class="step-num">STEP 04</div>
                <div class="step-title">Analyst Post-Pass</div>
                <div class="step-text">Content Analyst runs over all text outputs ‚Äî scoring sentiment (‚àí1 to +1),
                    tagging category (politics, finance, tech‚Ä¶)</div>
            </div>
            <div class="step">
                <div class="step-num">STEP 05</div>
                <div class="step-title">Cross-Source Aggregation</div>
                <div class="step-text">Aggregator runs after barrier sync ‚Äî finds intersections across all sources (e.g.
                    PDF org = YouTube speaker)</div>
            </div>
            <div class="step">
                <div class="step-num">STEP 06</div>
                <div class="step-title">Dashboard Render</div>
                <div class="step-text">WebSockets stream intelligence cards to the React frontend (from ZIP) in
                    real-time as each agent finishes</div>
            </div>
        </div>

        <!-- 03 AGENT ROLE DEFINITIONS -->
        <div class="section-title">03 ‚Äî Agent Roles, Responsibilities &amp; MCP Tools</div>
        <div class="agents-grid">

            <div class="agent-card orchestrator">
                <div class="agent-badge">Orchestrator</div>
                <h3>üß† Central Router</h3>
                <p class="description">The brain of the system. Receives the mixed-media payload, detects file types,
                    builds the execution DAG, fires all MCP tool calls in the right order, and collates final output
                    into the dashboard payload. Handles retries and error propagation.</p>
                <div class="tools-label">Responsibilities</div>
                <ul class="resp-list">
                    <li>Unpack ZIP ‚Üí classify all items (MIME detection)</li>
                    <li>Decide agent dispatch order (parallel vs sequential)</li>
                    <li>Collect outputs from all MCP tools</li>
                    <li>Trigger aggregator after barrier sync</li>
                    <li>Push final JSON via WebSocket to React dashboard</li>
                </ul>
                <div style="margin-top:12px;">
                    <div class="kv-row"><span class="kv-key">Model</span><span class="kv-val">claude-sonnet-4-6</span>
                    </div>
                    <div class="kv-row"><span class="kv-key">Pattern</span><span class="kv-val">Scatter-Gather /
                            MapReduce</span></div>
                    <div class="kv-row"><span class="kv-key">MCP Calls</span><span class="kv-val">transcribe_video ¬∑
                            parse_pdf ¬∑ parse_web ¬∑ analyze_content ¬∑ aggregate_intel</span></div>
                </div>
            </div>

            <div class="agent-card transcriber">
                <div class="agent-badge">MCP Tool 1</div>
                <h3>üéô Video Transcriber</h3>
                <p class="description">Accepts YouTube news video URLs or downloaded video files. Downloads via yt-dlp,
                    extracts audio, runs OpenAI Whisper for transcription, then cleans speaker labels and highlights key
                    quotes.</p>
                <div class="tools-label">Responsibilities</div>
                <ul class="resp-list">
                    <li>Download YouTube video audio (yt-dlp)</li>
                    <li>Run Whisper STT ‚Üí raw transcript</li>
                    <li>Clean noisy output, add speaker labels</li>
                    <li>Extract top 3‚Äì5 key quotes</li>
                    <li>Return JSON with transcript + metadata</li>
                </ul>
                <div style="margin-top:12px;">
                    <div class="kv-row"><span class="kv-key">MCP Tool</span><span
                            class="kv-val">transcribe_video(url)</span></div>
                    <div class="kv-row"><span class="kv-key">Input</span><span class="kv-val">youtube_url: str |
                            file_path: str</span></div>
                    <div class="kv-row"><span class="kv-key">Output</span><span class="kv-val">{ transcript,
                            key_quotes[], duration, source_url }</span></div>
                    <div class="kv-row"><span class="kv-key">Libs</span><span class="kv-val">yt-dlp, openai-whisper,
                            ffmpeg</span></div>
                </div>
            </div>

            <div class="agent-card extractor">
                <div class="agent-badge">MCP Tool 2</div>
                <h3>üìÑ PDF Document Extractor</h3>
                <p class="description">Triggered on every news PDF uploaded. Uses PyMuPDF to extract raw text, then
                    Claude extracts named entities, publication dates, headline, and generates a 3-sentence executive
                    summary per document.</p>
                <div class="tools-label">Responsibilities</div>
                <ul class="resp-list">
                    <li>Parse PDF text layer (PyMuPDF, fallback Tesseract OCR)</li>
                    <li>Extract named entities: people, orgs, locations, dates</li>
                    <li>Generate headline + executive summary</li>
                    <li>Output structured JSON per PDF file</li>
                </ul>
                <div style="margin-top:12px;">
                    <div class="kv-row"><span class="kv-key">MCP Tool</span><span
                            class="kv-val">parse_pdf(file_path)</span></div>
                    <div class="kv-row"><span class="kv-key">Input</span><span class="kv-val">file_path: str
                            (PDF)</span></div>
                    <div class="kv-row"><span class="kv-key">Output</span><span class="kv-val">{ headline, summary,
                            entities[], dates[], raw_text }</span></div>
                    <div class="kv-row"><span class="kv-key">Libs</span><span class="kv-val">PyMuPDF, pytesseract,
                            anthropic</span></div>
                </div>
            </div>

            <div class="agent-card planner">
                <div class="agent-badge">MCP Tool 3</div>
                <h3>üåê Web Scrape Parser</h3>
                <p class="description">Receives raw HTML or pre-scraped JSON from the web scrape data input. Cleans
                    boilerplate, extracts article body, pulls author/date/source metadata, and normalises it into the
                    same schema as other sources.</p>
                <div class="tools-label">Responsibilities</div>
                <ul class="resp-list">
                    <li>Clean HTML ‚Üí extract article body text</li>
                    <li>Extract author, publication date, source domain</li>
                    <li>Normalise to unified article schema</li>
                    <li>Handle multiple articles per scrape batch</li>
                </ul>
                <div style="margin-top:12px;">
                    <div class="kv-row"><span class="kv-key">MCP Tool</span><span class="kv-val">parse_web(raw_html |
                            json_data)</span></div>
                    <div class="kv-row"><span class="kv-key">Input</span><span class="kv-val">html_or_json: str</span>
                    </div>
                    <div class="kv-row"><span class="kv-key">Output</span><span class="kv-val">{ title, body, author,
                            date, source, url }</span></div>
                    <div class="kv-row"><span class="kv-key">Libs</span><span class="kv-val">BeautifulSoup4,
                            newspaper3k, anthropic</span></div>
                </div>
            </div>

            <div class="agent-card analyst">
                <div class="agent-badge">MCP Tool 4</div>
                <h3>üìä Content Analyst &amp; Categorizer</h3>
                <p class="description">Runs as a post-processor over all text outputs from Tools 1‚Äì3. Scores sentiment
                    (‚àí1 to +1), detects political/ideological bias, assigns taxonomy tags (politics, finance, tech,
                    conflict, environment, etc.), and flags language/region.</p>
                <div class="tools-label">Responsibilities</div>
                <ul class="resp-list">
                    <li>Score sentiment ‚àí1 (negative) to +1 (positive)</li>
                    <li>Assign up to 3 taxonomy tags per article</li>
                    <li>Detect bias indicators (framing, loaded language)</li>
                    <li>Identify language and estimated region of coverage</li>
                </ul>
                <div style="margin-top:12px;">
                    <div class="kv-row"><span class="kv-key">MCP Tool</span><span class="kv-val">analyze_content(text,
                            source_id)</span></div>
                    <div class="kv-row"><span class="kv-key">Input</span><span class="kv-val">text: str, source_id:
                            str</span></div>
                    <div class="kv-row"><span class="kv-key">Output</span><span class="kv-val">{ sentiment: float,
                            tags[], bias_score, language }</span></div>
                    <div class="kv-row"><span class="kv-key">Model</span><span class="kv-val">claude-sonnet-4-6 (haiku
                            viable)</span></div>
                </div>
            </div>

            <div class="agent-card aggregator">
                <div class="agent-badge">MCP Tool 5</div>
                <h3>üîó Cross-Source Aggregator</h3>
                <p class="description">The final step ‚Äî runs only after asyncio barrier sync confirms all parallel tools
                    complete. Receives the full knowledge space and finds cross-source links (e.g. org name in PDF
                    matches YouTube speaker, same event covered by both web and video), then generates the unified
                    intelligence report.</p>
                <div class="tools-label">Responsibilities</div>
                <ul class="resp-list">
                    <li>Wait for all agent results (asyncio.gather barrier)</li>
                    <li>Find entity intersections across all sources</li>
                    <li>Build unified timeline of events</li>
                    <li>Generate 1-page executive intelligence brief</li>
                    <li>Return dashboard-ready JSON payload for React UI</li>
                </ul>
                <div style="margin-top:12px;">
                    <div class="kv-row"><span class="kv-key">MCP Tool</span><span
                            class="kv-val">aggregate_intel(all_results: dict)</span></div>
                    <div class="kv-row"><span class="kv-key">Trigger</span><span class="kv-val">barrier sync (all tools
                            complete)</span></div>
                    <div class="kv-row"><span class="kv-key">Output</span><span class="kv-val">{ unified_brief,
                            cross_links[], timeline[], dashboard_cards[] }</span></div>
                    <div class="kv-row"><span class="kv-key">Context</span><span class="kv-val">200k token window (large
                            context pass)</span></div>
                </div>
            </div>

        </div>
    </div>

    <!-- 04 PROMPT TEMPLATES -->
    <div class="section-title">04 ‚Äî Agent System Prompts</div>
    <div class="code-section">
        <div class="tabs">
            <button class="tab active" onclick="showTab('p-orch',this)">Orchestrator</button>
            <button class="tab" onclick="showTab('p-trans',this)">Transcriber</button>
            <button class="tab" onclick="showTab('p-pdf',this)">PDF Extractor</button>
            <button class="tab" onclick="showTab('p-web',this)">Web Parser</button>
            <button class="tab" onclick="showTab('p-analyst',this)">Analyst</button>
            <button class="tab" onclick="showTab('p-agg',this)">Aggregator</button>
        </div>

        <div class="code-block active" id="p-orch">
            <button class="copy-btn" onclick="copyCode('p-orch')">COPY</button>
            <pre><span class="v">ORCHESTRATOR_PROMPT</span> = <span class="s">"""
You are the Orchestrator for a Media Intelligence Platform.
You receive a list of input files and their types. Your job:
1. Classify each input: youtube_url | pdf | web_scrape | zip_frontend
2. Build an execution plan ‚Äî which MCP tools to call and in what order
3. Call Tools 1-4 in PARALLEL via asyncio.gather for independent sources
4. Call Tool 5 (aggregator) ONLY AFTER all parallel tools complete

Return execution plan as JSON ONLY:
{
  "parallel_batch": [
    {"tool": "transcribe_video", "input": "...", "source_id": "yt_001"},
    {"tool": "parse_pdf",        "input": "...", "source_id": "pdf_001"},
    {"tool": "parse_web",        "input": "...", "source_id": "web_001"}
  ],
  "sequential_after": [
    {"tool": "analyze_content",  "depends_on": ["yt_001","pdf_001","web_001"]},
    {"tool": "aggregate_intel",  "depends_on": "all"}
  ]
}
No markdown. Pure JSON only.
"""</span></pre>
        </div>

        <div class="code-block" id="p-trans">
            <button class="copy-btn" onclick="copyCode('p-trans')">COPY</button>
            <pre><span class="v">TRANSCRIBER_PROMPT</span> = <span class="s">"""
You are a journalist-grade transcript editor.
You receive a raw Whisper transcript of a news video. Your job:
1. Clean stutters, filler words, and transcription errors
2. Add speaker labels where inference is possible
3. Highlight the 3-5 most significant quotes
4. Generate a 2-sentence summary

Return ONLY:
{
  "source_id": "...",
  "summary": "2-sentence video summary.",
  "transcript_clean": "Full cleaned transcript...",
  "key_quotes": [
    {"speaker": "Speaker A", "quote": "...", "significance": "..."}
  ],
  "duration_seconds": 0,
  "language": "en"
}
No markdown. Pure JSON only.
"""</span></pre>
        </div>

        <div class="code-block" id="p-pdf">
            <button class="copy-btn" onclick="copyCode('p-pdf')">COPY</button>
            <pre><span class="v">PDF_EXTRACTOR_PROMPT</span> = <span class="s">"""
You are a document intelligence agent.
You receive raw text extracted from a news PDF. Your job:
1. Identify headline / title
2. Extract named entities: people, orgs, locations, dates
3. Write a 3-sentence executive summary
4. Identify primary topic

Return ONLY:
{
  "source_id": "...",
  "headline": "Article headline",
  "summary": "3-sentence executive summary.",
  "entities": {
    "people": [], "organizations": [],
    "locations": [], "dates": []
  },
  "topic": "politics|finance|conflict|technology|other",
  "publication_date": "YYYY-MM-DD or null"
}
No markdown. Pure JSON only.
"""</span></pre>
        </div>

        <div class="code-block" id="p-web">
            <button class="copy-btn" onclick="copyCode('p-web')">COPY</button>
            <pre><span class="v">WEB_PARSER_PROMPT</span> = <span class="s">"""
You are a web content normalisation agent.
You receive raw HTML or pre-scraped article JSON. Your job:
1. Extract the clean article body text (remove ads/nav/footer)
2. Identify author name(s) and publication date
3. Extract source domain and URL
4. Write a 2-sentence summary

Return ONLY:
{
  "source_id": "...",
  "title": "Article title",
  "summary": "2-sentence summary.",
  "body": "Clean article body...",
  "author": "Name or null",
  "date": "YYYY-MM-DD or null",
  "source_domain": "example.com",
  "url": "https://... or null"
}
No markdown. Pure JSON only.
"""</span></pre>
        </div>

        <div class="code-block" id="p-analyst">
            <button class="copy-btn" onclick="copyCode('p-analyst')">COPY</button>
            <pre><span class="v">ANALYST_PROMPT</span> = <span class="s">"""
You are a media bias and sentiment analysis agent.
You receive text output from a single intelligence source. Your job:
1. Score overall sentiment: -1.0 (very negative) to +1.0 (very positive)
2. Assign up to 3 taxonomy tags:
   politics|finance|conflict|technology|environment|health|crime|diplomacy
3. Estimate ideological framing
4. Detect primary language and region of coverage

Return ONLY:
{
  "source_id": "...",
  "sentiment": 0.0,
  "tags": ["politics", "diplomacy"],
  "framing": "centrist|left-leaning|right-leaning|neutral|unclear",
  "language": "en",
  "region": "South Asia",
  "bias_indicators": ["..."]
}
No markdown. Pure JSON only.
"""</span></pre>
        </div>

        <div class="code-block" id="p-agg">
            <button class="copy-btn" onclick="copyCode('p-agg')">COPY</button>
            <pre><span class="v">AGGREGATOR_PROMPT</span> = <span class="s">"""
You are a senior intelligence analyst synthesising a multi-source media brief.
You receive JSON outputs from ALL agents in this pipeline run. Your job:
1. Identify entities appearing across multiple sources
2. Build a unified timeline of events
3. Find disparities / contradictions between sources
4. Write a 5-7 sentence executive intelligence brief
5. Generate dashboard_cards (one per unique story angle) for React UI

Return ONLY:
{
  "run_id": "...",
  "brief": "5-7 sentence summary of all intelligence gathered.",
  "cross_links": [
    {"entity": "Name", "found_in": ["pdf_001","yt_002"], "context": "..."}
  ],
  "timeline": [{"date": "YYYY-MM-DD", "event": "...", "sources": []}],
  "contradictions": [],
  "dashboard_cards": [
    {
      "id": "card_001", "headline": "...", "summary": "...",
      "sentiment": 0.0, "tags": [], "sources": [], "timestamp": "ISO-8601"
    }
  ],
  "total_sources_processed": 0
}
No markdown. Pure JSON only.
"""</span></pre>
        </div>
    </div>

    <!-- 05 TOKEN & COST ESTIMATES -->
    <div class="section-title">05 ‚Äî Per-Agent Token &amp; Cost Estimates</div>
    <table class="cost-table">
        <thead>
            <tr>
                <th>Agent</th>
                <th>Model</th>
                <th>Avg Input Tok</th>
                <th>Avg Output Tok</th>
                <th>Cost / Call</th>
                <th>Calls / Run</th>
                <th>Est. Cost / Run</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>üß† Orchestrator</td>
                <td class="mono">claude-sonnet-4-6</td>
                <td class="mono">~10,000</td>
                <td class="mono">~2,000</td>
                <td class="mono">~$0.060</td>
                <td class="mono">1</td>
                <td class="mono"><span class="badge-pill pill-t">~$0.06</span></td>
                <td>Payload manifest + all file metadata + routing plan. Worst case: large ZIP with many sources.</td>
            </tr>
            <tr>
                <td>üéô Transcriber</td>
                <td class="mono">Whisper + claude-sonnet-4-6</td>
                <td class="mono">~15,000</td>
                <td class="mono">~2,000</td>
                <td class="mono">~$0.075</td>
                <td class="mono">up to 10 videos</td>
                <td class="mono"><span class="badge-pill pill-p">~$0.75</span></td>
                <td>15-min video = ~15k tokens transcript. Whisper free; Sonnet cleans + extracts key quotes.</td>
            </tr>
            <tr>
                <td>üìÑ PDF Extractor</td>
                <td class="mono">claude-sonnet-4-6</td>
                <td class="mono">~10,000</td>
                <td class="mono">~2,000</td>
                <td class="mono">~$0.060</td>
                <td class="mono">up to 10 PDFs</td>
                <td class="mono"><span class="badge-pill pill-p">~$0.60</span></td>
                <td>Dense newspaper PDFs can fill 10k tokens. PyMuPDF parsing free; Sonnet entity extraction.</td>
            </tr>
            <tr>
                <td>üåê Web Parser</td>
                <td class="mono">claude-sonnet-4-6</td>
                <td class="mono">~6,000</td>
                <td class="mono">~1,000</td>
                <td class="mono">~$0.033</td>
                <td class="mono">up to 20 articles</td>
                <td class="mono"><span class="badge-pill pill-p">~$0.66</span></td>
                <td>Long-form news articles can be 5‚Äì6k tokens after BS4 strip. Sonnet ensures accurate normalisation.
                </td>
            </tr>
            <tr>
                <td>üìä Content Analyst</td>
                <td class="mono">claude-sonnet-4-6</td>
                <td class="mono">~6,000</td>
                <td class="mono">~1,500</td>
                <td class="mono">~$0.041</td>
                <td class="mono">up to 30 sources</td>
                <td class="mono"><span class="badge-pill pill-a">~$1.21</span></td>
                <td>Runs once per source. High call count drives cost. Sonnet gives reliable sentiment + taxonomy.</td>
            </tr>
            <tr>
                <td>üîó Aggregator</td>
                <td class="mono">claude-sonnet-4-6</td>
                <td class="mono">~40k‚Äì60k</td>
                <td class="mono">~5,000</td>
                <td class="mono">~$0.195‚Äì$0.255</td>
                <td class="mono">1 (final)</td>
                <td class="mono"><span class="badge-pill pill-a">~$0.195‚Äì$0.255</span></td>
                <td>All agent outputs merged into one massive context. 200k token window = future headroom.</td>
            </tr>
            <tr style="border-top:2px solid var(--accent);">
                <td style="color:var(--accent2);font-weight:800;">TOTAL WORST CASE</td>
                <td class="mono">all Sonnet</td>
                <td class="mono">‚Äî</td>
                <td class="mono">‚Äî</td>
                <td class="mono">‚Äî</td>
                <td class="mono">‚Äî</td>
                <td class="mono"><span class="badge-pill pill-a"
                        style="font-size:13px;padding:4px 12px;">~$3.00‚Äì$3.50</span></td>
                <td>10 YT + 10 PDFs + 20 web articles + 30 analysis passes + aggregation. All on Sonnet.</td>
            </tr>
        </tbody>
    </table>

    <!-- Cost Summary Cards -->
    <div class="cost-grid" style="margin-top:24px;">
        <div class="cost-card">
            <div class="cost-label">Typical Run</div>
            <div class="cost-val">~$1.20</div>
            <div class="cost-unit">per full batch (all Sonnet)</div>
            <div class="cost-note">5 videos + 5 PDFs + 10 web articles + 15 analysis passes + aggregation.</div>
        </div>
        <div class="cost-card">
            <div class="cost-label">Light Run</div>
            <div class="cost-val">~$0.35</div>
            <div class="cost-unit">per small batch</div>
            <div class="cost-note">1 video + 2 PDFs + 3 web articles + 6 analysis passes. Demo scenario.</div>
        </div>
        <div class="cost-card">
            <div class="cost-label">WORST Case</div>
            <div class="cost-val">~$3.50</div>
            <div class="cost-unit">per max archive (all Sonnet)</div>
            <div class="cost-note">10 videos + 10 PDFs + 20 articles + 30 analysis passes. Aggregator hits 60k tokens.
            </div>
        </div>
        <div class="cost-card">
            <div class="cost-label">Monthly Budget</div>
            <div class="cost-val">~$105</div>
            <div class="cost-unit">30 typical runs / month</div>
            <div class="cost-note">Daily broadcast analysis cycle. Plan for $150/mo buffer. Heavy days cost ~$10.50.
            </div>
        </div>
    </div>

    <!-- 05b DEVELOPMENT COST -->
    <div class="section-title" style="color:var(--accent2);">05b ‚Äî Real Development Cost (You're Right, Way More Than
        $3.50)</div>

    <div class="task-banner task-c"
        style="border-color:var(--accent2); background:rgba(255,79,139,0.06); margin-bottom:32px;">
        <span class="task-tag" style="background:rgba(255,79,139,0.2); color:var(--accent2);">‚ö† REALITY CHECK</span>
        <span>The $3.50 figure is <strong style="color:var(--text);">only the per-run production inference
                cost</strong>. During development you also burn tokens on code generation, prompt engineering,
            debugging, and repeated test runs. This section estimates the <strong style="color:var(--accent2);">actual
                total spend to build and ship the platform</strong>.</span>
    </div>

    <table class="cost-table" style="margin-bottom:32px;">
        <thead>
            <tr>
                <th>Dev Activity</th>
                <th>What Claude Is Doing</th>
                <th>Avg Input / Call</th>
                <th>Avg Output / Call</th>
                <th>Cost / Call</th>
                <th>Est. # Calls</th>
                <th>Subtotal</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>üîß Code Generation</td>
                <td>Writing MCP servers, FastAPI routes, DB config, React hooks ‚Äî full files at a time</td>
                <td class="mono">~20,000</td>
                <td class="mono">~4,000</td>
                <td class="mono">~$0.12</td>
                <td class="mono">80‚Äì120 sessions</td>
                <td class="mono"><span class="badge-pill pill-a">~$9.60‚Äì$14.40</span></td>
            </tr>
            <tr>
                <td>üîÅ Prompt Engineering</td>
                <td>Iterating system prompts per agent: send test output ‚Üí refine ‚Üí re-test (6 agents √ó 10 rounds)</td>
                <td class="mono">~6,000</td>
                <td class="mono">~2,000</td>
                <td class="mono">~$0.048</td>
                <td class="mono">60 iterations</td>
                <td class="mono"><span class="badge-pill pill-a">~$2.88</span></td>
            </tr>
            <tr>
                <td>üß™ Test Pipeline Runs</td>
                <td>Running the full end-to-end pipeline during development to verify agent outputs are correct</td>
                <td class="mono">varies</td>
                <td class="mono">varies</td>
                <td class="mono">~$1.20 / run</td>
                <td class="mono">40‚Äì60 runs</td>
                <td class="mono"><span class="badge-pill pill-a">~$48‚Äì$72</span></td>
            </tr>
            <tr>
                <td>üêõ Debug Sessions</td>
                <td>Sending stack traces + full code context to Claude for error diagnosis + fix suggestions</td>
                <td class="mono">~12,000</td>
                <td class="mono">~2,500</td>
                <td class="mono">~$0.073</td>
                <td class="mono">50‚Äì80 sessions</td>
                <td class="mono"><span class="badge-pill pill-a">~$3.65‚Äì$5.84</span></td>
            </tr>
            <tr>
                <td>üìê Schema &amp; Config Iterations</td>
                <td>Refining DB schema, .env values, MCP tool signatures, Vite proxy settings</td>
                <td class="mono">~5,000</td>
                <td class="mono">~1,500</td>
                <td class="mono">~$0.037</td>
                <td class="mono">20‚Äì30 sessions</td>
                <td class="mono"><span class="badge-pill pill-p">~$0.74‚Äì$1.11</span></td>
            </tr>
            <tr>
                <td>üîó Integration Testing</td>
                <td>Connecting all 5 MCP servers to orchestrator, verifying WebSocket stream, checking DB writes</td>
                <td class="mono">~15,000</td>
                <td class="mono">~3,000</td>
                <td class="mono">~$0.09</td>
                <td class="mono">20‚Äì30 sessions</td>
                <td class="mono"><span class="badge-pill pill-p">~$1.80‚Äì$2.70</span></td>
            </tr>
            <tr>
                <td>üé® React Frontend Wiring</td>
                <td>Adapting existing React ZIP to consume the new API: hooks, props, live card rendering</td>
                <td class="mono">~18,000</td>
                <td class="mono">~4,000</td>
                <td class="mono">~$0.114</td>
                <td class="mono">25‚Äì40 sessions</td>
                <td class="mono"><span class="badge-pill pill-p">~$2.85‚Äì$4.56</span></td>
            </tr>
            <tr>
                <td>üìã Code Reviews &amp; Refactors</td>
                <td>Asking Claude to audit each file, spot bugs, improve error handling, add type hints</td>
                <td class="mono">~20,000</td>
                <td class="mono">~3,000</td>
                <td class="mono">~$0.105</td>
                <td class="mono">20‚Äì30 sessions</td>
                <td class="mono"><span class="badge-pill pill-p">~$2.10‚Äì$3.15</span></td>
            </tr>
            <tr style="border-top:2px solid var(--accent2);">
                <td style="color:var(--accent2);font-weight:800;">TOTAL DEV BUDGET</td>
                <td colspan="5" style="color:var(--muted); font-size:12px;">Full build cycle: Phase 1 + Phase 2 + Phase
                    3 + all prompt iterations + ~50 full test runs</td>
                <td class="mono"><span class="badge-pill pill-a"
                        style="font-size:13px;padding:4px 12px;background:rgba(255,79,139,0.2);color:var(--accent2);">~$75‚Äì$110</span>
                </td>
            </tr>
            <tr>
                <td style="color:var(--accent4);font-weight:800;">WORST CASE DEV</td>
                <td colspan="5" style="color:var(--muted); font-size:12px;">Multiple refactors, heavy debugging, 100+
                    test runs, architecture pivots, solo developer iterating fast</td>
                <td class="mono"><span class="badge-pill pill-a"
                        style="font-size:13px;padding:4px 12px;background:rgba(255,195,79,0.2);color:var(--accent4);">~$200‚Äì$300</span>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- Dev vs Prod Cost Breakdown Cards -->
    <div class="cost-grid" style="margin-bottom:48px; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));">
        <div class="cost-card" style="border-color:rgba(255,79,139,0.3); background:rgba(255,79,139,0.05);">
            <div class="cost-label" style="color:var(--accent2);">Dev-Time Cost</div>
            <div class="cost-val">~$150</div>
            <div class="cost-unit">total to build the platform</div>
            <div class="cost-note">Code gen + prompts + ~50 full test runs + debugging. Dominated by repeated test
                pipeline executions.</div>
        </div>
        <div class="cost-card">
            <div class="cost-label">Runtime Cost</div>
            <div class="cost-val">~$1.20</div>
            <div class="cost-unit">per production run</div>
            <div class="cost-note">Typical batch: 5 YT + 5 PDFs + 10 articles. All Sonnet. This is post-launch recurring
                cost.</div>
        </div>
        <div class="cost-card" style="border-color:rgba(255,79,139,0.3); background:rgba(255,79,139,0.05);">
            <div class="cost-label" style="color:var(--accent2);">Biggest Dev Drain</div>
            <div class="cost-val">Test Runs</div>
            <div class="cost-unit">~50 runs √ó $1.20 = $60</div>
            <div class="cost-note">Every time you run the pipeline to check if your fix worked, you spend $1.20. 50 test
                runs = $60 alone.</div>
        </div>
        <div class="cost-card" style="border-color:rgba(255,195,79,0.3); background:rgba(255,195,79,0.05);">
            <div class="cost-label" style="color:var(--accent4);">Smart Dev Tip</div>
            <div class="cost-val">Mock Data</div>
            <div class="cost-unit">saves ~$40‚Äì$60 in dev</div>
            <div class="cost-note">Use cached mock responses for agent outputs during UI + wiring dev. Only hit real
                LLMs for final agent validation.</div>
        </div>
    </div>

    <!-- 06 BUILD ROADMAP -->
    <div class="section-title">06 ‚Äî 3-Phase Agent Build Roadmap</div>
    <div class="roadmap">
        <div class="phase">
            <div class="phase-label">Phase 1 ‚Äî Foundation</div>
            <h3>Backend + MCP Shell</h3>
            <ul>
                <li>FastAPI multipart upload endpoint (ZIP, PDF, URL list)</li>
                <li>MCP server skeleton exposing all 5 tool stubs</li>
                <li>MIME detection + input classifier (python-magic)</li>
                <li>asyncio DAG executor + asyncio.gather parallel dispatch</li>
                <li>WebSocket endpoint to stream agent results to UI</li>
            </ul>
        </div>
        <div class="phase">
            <div class="phase-label">Phase 2 ‚Äî Agents</div>
            <h3>Tool Implementations</h3>
            <ul>
                <li>Tool 1: yt-dlp download ‚Üí Whisper STT ‚Üí Claude cleanup</li>
                <li>Tool 2: PyMuPDF parse ‚Üí Claude entity extraction</li>
                <li>Tool 3: BeautifulSoup4 clean ‚Üí Claude normalisation</li>
                <li>Tool 4: Claude Haiku sentiment + categorisation</li>
                <li>Tool 5: Aggregator prompt + barrier sync + dashboard JSON</li>
            </ul>
        </div>
        <div class="phase">
            <div class="phase-label">Phase 3 ‚Äî Frontend</div>
            <h3>React Dashboard (ZIP)</h3>
            <ul>
                <li>Wire React ZIP dashboard to FastAPI WebSocket</li>
                <li>Add file upload dropzone (ZIP, PDFs, URL list)</li>
                <li>Stream intelligence cards live as agents complete</li>
                <li>Display sentiment scores, tags, entity network</li>
                <li>End-to-end test + demo recording for presentation</li>
            </ul>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- TASK A ‚Äî 07: MULTIPLE MCP SERVERS                         -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="section-title">07 ‚Äî Multiple MCP Servers (Domain-Isolated Architecture)</div>
    <div class="task-banner task-a">
        <span class="task-tag">TASK A</span>
        <span>Deploy 5 dedicated MCP server processes ‚Äî one per domain ‚Äî each on its own port, independently scalable,
            testable, and restartable without affecting other pipelines. The orchestrator connects to ALL via SSE
            transport at startup.</span>
    </div>

    <div class="arch-diagram" style="margin-bottom:24px;">
        <div class="mcp-topology">
            <div class="topo-orchestrator">
                <div class="topo-label">FastAPI Backend ‚Äî Port 8000</div>
                <div class="topo-name">üß† Orchestrator ¬∑ Connects to ALL 5 MCP servers via SSE</div>
            </div>
            <div class="topo-arrows">‚Üì routes tool_use calls per input domain ‚Üì</div>
            <div class="topo-grid">
                <div class="topo-server s-media">
                    <div class="topo-server-port">:6001</div>
                    <div class="topo-server-name">üéô Media MCP</div>
                    <div class="topo-server-tool">transcribe_video(url)</div>
                    <div class="topo-server-tech">yt-dlp ¬∑ whisper ¬∑ ffmpeg</div>
                </div>
                <div class="topo-server s-doc">
                    <div class="topo-server-port">:6002</div>
                    <div class="topo-server-name">üìÑ Document MCP</div>
                    <div class="topo-server-tool">parse_pdf(path)</div>
                    <div class="topo-server-tech">PyMuPDF ¬∑ tesseract ¬∑ anthropic</div>
                </div>
                <div class="topo-server s-web">
                    <div class="topo-server-port">:6003</div>
                    <div class="topo-server-name">üåê Web MCP</div>
                    <div class="topo-server-tool">parse_web(html)</div>
                    <div class="topo-server-tech">BeautifulSoup4 ¬∑ newspaper3k</div>
                </div>
                <div class="topo-server s-analysis">
                    <div class="topo-server-port">:6004</div>
                    <div class="topo-server-name">üìä Analysis MCP</div>
                    <div class="topo-server-tool">analyze_content(text)</div>
                    <div class="topo-server-tech">anthropic haiku</div>
                </div>
                <div class="topo-server s-agg">
                    <div class="topo-server-port">:6005</div>
                    <div class="topo-server-name">üîó Aggregation MCP</div>
                    <div class="topo-server-tool">aggregate_intel(results)</div>
                    <div class="topo-server-tech">anthropic sonnet ¬∑ asyncpg</div>
                </div>
            </div>
            <div class="topo-arrows">‚Üì all servers write results via shared pool ‚Üì</div>
            <div class="topo-db">üóÑÔ∏è PostgreSQL ‚Äî intelligence_db (shared asyncpg pool, connection_timeout=30s)</div>
        </div>
    </div>

    <div class="code-section" style="margin-bottom:48px;">
        <div class="tabs">
            <button class="tab active" onclick="showTab('mcp-reg',this)">Server Registry</button>
            <button class="tab" onclick="showTab('mcp-media',this)">Media MCP :6001</button>
            <button class="tab" onclick="showTab('mcp-doc',this)">Document MCP :6002</button>
            <button class="tab" onclick="showTab('mcp-web',this)">Web MCP :6003</button>
            <button class="tab" onclick="showTab('mcp-analysis',this)">Analysis MCP :6004</button>
            <button class="tab" onclick="showTab('mcp-agg',this)">Aggregation MCP :6005</button>
        </div>
        <div class="code-block active" id="mcp-reg">
            <button class="copy-btn" onclick="copyCode('mcp-reg')">COPY</button>
            <pre><span class="c"># config/mcp_registry.py ‚Äî orchestrator connects to all 5 MCP servers at startup</span>
<span class="k">from</span> <span class="n">mcp</span> <span class="k">import</span> <span class="n">ClientSession</span>, <span class="n">SSEServerParameters</span>
<span class="k">import</span> <span class="n">asyncio</span>

MCP_SERVERS = {
    <span class="s">"media"</span>:    <span class="v">6001</span>, <span class="c"># transcribe_video</span>
    <span class="s">"document"</span>: <span class="v">6002</span>, <span class="c"># parse_pdf</span>
    <span class="s">"web"</span>:      <span class="v">6003</span>, <span class="c"># parse_web</span>
    <span class="s">"analysis"</span>: <span class="v">6004</span>, <span class="c"># analyze_content</span>
    <span class="s">"agg"</span>:      <span class="v">6005</span>, <span class="c"># aggregate_intel</span>
}

<span class="k">async def</span> <span class="n">connect_all</span>() -> <span class="b">dict</span>:
    sessions = {}
    <span class="k">async def</span> <span class="n">_connect</span>(name, port):
        params = SSEServerParameters(url=<span class="s">f"http://localhost:{port}/sse"</span>)
        sessions[name] = <span class="k">await</span> ClientSession.connect(params)
        <span class="b">print</span>(<span class="s">f"‚úì {name} MCP connected @ :{port}"</span>)
    <span class="k">await</span> asyncio.gather(*[_connect(n,p) <span class="k">for</span> n,p <span class="k">in</span> MCP_SERVERS.items()])
    <span class="k">return</span> sessions

<span class="c"># Start all servers (one-liner for dev):</span>
<span class="c"># uvicorn main:app &amp; python -m servers.media_mcp &amp; python -m servers.document_mcp \</span>
<span class="c">#   &amp; python -m servers.web_mcp &amp; python -m servers.analysis_mcp &amp; python -m servers.aggregation_mcp</span></pre>
        </div>
        <div class="code-block" id="mcp-media">
            <button class="copy-btn" onclick="copyCode('mcp-media')">COPY</button>
            <pre><span class="c"># servers/media_mcp.py ‚Äî run separately:  python -m servers.media_mcp</span>
<span class="k">from</span> <span class="n">mcp.server.fastmcp</span> <span class="k">import</span> <span class="n">FastMCP</span>
<span class="k">import</span> <span class="n">yt_dlp</span>, <span class="n">whisper</span>, <span class="n">anthropic</span>, <span class="n">json</span>

mcp = <span class="n">FastMCP</span>(<span class="s">"media_mcp"</span>)

<span class="k">@mcp.tool</span>()
<span class="k">async def</span> <span class="n">transcribe_video</span>(url: <span class="b">str</span>, source_id: <span class="b">str</span>) -> <span class="b">dict</span>:
    ydl_opts = {<span class="s">"format"</span>: <span class="s">"bestaudio"</span>, <span class="s">"outtmpl"</span>: <span class="s">f"/tmp/{source_id}.%(ext)s"</span>}
    <span class="k">with</span> yt_dlp.YoutubeDL(ydl_opts) <span class="k">as</span> ydl:
        ydl.extract_info(url, download=<span class="k">True</span>)
    model = whisper.load_model(<span class="s">"base"</span>)
    raw = model.transcribe(<span class="s">f"/tmp/{source_id}.webm"</span>)[<span class="s">"text"</span>]
    client = anthropic.Anthropic()
    msg = client.messages.create(model=<span class="s">"claude-haiku-4-5"</span>, max_tokens=<span class="v">1024</span>,
        system=TRANSCRIBER_PROMPT, messages=[{<span class="s">"role"</span>:<span class="s">"user"</span>,<span class="s">"content"</span>:raw}])
    <span class="k">return</span> json.loads(msg.content[<span class="v">0</span>].text)

<span class="k">if</span> __name__ == <span class="s">"__main__"</span>:
    mcp.run(transport=<span class="s">"sse"</span>, port=<span class="v">6001</span>)  <span class="c"># ‚Üí http://localhost:6001/sse</span></pre>
        </div>
        <div class="code-block" id="mcp-doc">
            <button class="copy-btn" onclick="copyCode('mcp-doc')">COPY</button>
            <pre><span class="c"># servers/document_mcp.py ‚Äî run separately:  python -m servers.document_mcp</span>
<span class="k">from</span> <span class="n">mcp.server.fastmcp</span> <span class="k">import</span> <span class="n">FastMCP</span>
<span class="k">import</span> <span class="n">fitz</span>, <span class="n">anthropic</span>, <span class="n">json</span>

mcp = <span class="n">FastMCP</span>(<span class="s">"document_mcp"</span>)

<span class="k">@mcp.tool</span>()
<span class="k">async def</span> <span class="n">parse_pdf</span>(file_path: <span class="b">str</span>, source_id: <span class="b">str</span>) -> <span class="b">dict</span>:
    doc = fitz.open(file_path)
    raw = <span class="s">"\n"</span>.join(p.get_text() <span class="k">for</span> p <span class="k">in</span> doc)
    <span class="k">if</span> <span class="b">len</span>(raw.strip()) < <span class="v">100</span>:
        raw = run_ocr(file_path)  <span class="c"># pytesseract fallback</span>
    client = anthropic.Anthropic()
    msg = client.messages.create(model=<span class="s">"claude-sonnet-4-6"</span>, max_tokens=<span class="v">1500</span>,
        system=PDF_EXTRACTOR_PROMPT,
        messages=[{<span class="s">"role"</span>:<span class="s">"user"</span>,<span class="s">"content"</span>:raw[:<span class="v">8000</span>]}])
    res = json.loads(msg.content[<span class="v">0</span>].text)
    res[<span class="s">"source_id"</span>] = source_id
    <span class="k">return</span> res

<span class="k">if</span> __name__ == <span class="s">"__main__"</span>:
    mcp.run(transport=<span class="s">"sse"</span>, port=<span class="v">6002</span>)  <span class="c"># ‚Üí http://localhost:6002/sse</span></pre>
        </div>
        <div class="code-block" id="mcp-web">
            <button class="copy-btn" onclick="copyCode('mcp-web')">COPY</button>
            <pre><span class="c"># servers/web_mcp.py ‚Äî run separately:  python -m servers.web_mcp</span>
<span class="k">from</span> <span class="n">mcp.server.fastmcp</span> <span class="k">import</span> <span class="n">FastMCP</span>
<span class="k">from</span> <span class="n">bs4</span> <span class="k">import</span> <span class="n">BeautifulSoup</span>
<span class="k">import</span> <span class="n">anthropic</span>, <span class="n">json</span>

mcp = <span class="n">FastMCP</span>(<span class="s">"web_mcp"</span>)

<span class="k">@mcp.tool</span>()
<span class="k">async def</span> <span class="n">parse_web</span>(html_or_json: <span class="b">str</span>, source_id: <span class="b">str</span>) -> <span class="b">dict</span>:
    soup = BeautifulSoup(html_or_json, <span class="s">"lxml"</span>)
    <span class="k">for</span> t <span class="k">in</span> soup([<span class="s">"script"</span>,<span class="s">"style"</span>,<span class="s">"nav"</span>,<span class="s">"footer"</span>,<span class="s">"aside"</span>]): t.decompose()
    clean = soup.get_text(separator=<span class="s">"\n"</span>, strip=<span class="k">True</span>)
    client = anthropic.Anthropic()
    msg = client.messages.create(model=<span class="s">"claude-haiku-4-5"</span>, max_tokens=<span class="v">1000</span>,
        system=WEB_PARSER_PROMPT,
        messages=[{<span class="s">"role"</span>:<span class="s">"user"</span>,<span class="s">"content"</span>:clean[:<span class="v">5000</span>]}])
    <span class="k">return</span> json.loads(msg.content[<span class="v">0</span>].text)

<span class="k">if</span> __name__ == <span class="s">"__main__"</span>:
    mcp.run(transport=<span class="s">"sse"</span>, port=<span class="v">6003</span>)  <span class="c"># ‚Üí http://localhost:6003/sse</span></pre>
        </div>
        <div class="code-block" id="mcp-analysis">
            <button class="copy-btn" onclick="copyCode('mcp-analysis')">COPY</button>
            <pre><span class="c"># servers/analysis_mcp.py ‚Äî run separately:  python -m servers.analysis_mcp</span>
<span class="k">from</span> <span class="n">mcp.server.fastmcp</span> <span class="k">import</span> <span class="n">FastMCP</span>
<span class="k">import</span> <span class="n">anthropic</span>, <span class="n">json</span>

mcp = <span class="n">FastMCP</span>(<span class="s">"analysis_mcp"</span>)

<span class="k">@mcp.tool</span>()
<span class="k">async def</span> <span class="n">analyze_content</span>(text: <span class="b">str</span>, source_id: <span class="b">str</span>) -> <span class="b">dict</span>:
    client = anthropic.Anthropic()
    msg = client.messages.create(model=<span class="s">"claude-haiku-4-5"</span>, max_tokens=<span class="v">500</span>,
        system=ANALYST_PROMPT,
        messages=[{<span class="s">"role"</span>:<span class="s">"user"</span>,<span class="s">"content"</span>:text[:<span class="v">4000</span>]}])
    res = json.loads(msg.content[<span class="v">0</span>].text)
    res[<span class="s">"source_id"</span>] = source_id
    <span class="k">return</span> res

<span class="k">if</span> __name__ == <span class="s">"__main__"</span>:
    mcp.run(transport=<span class="s">"sse"</span>, port=<span class="v">6004</span>)  <span class="c"># ‚Üí http://localhost:6004/sse</span></pre>
        </div>
        <div class="code-block" id="mcp-agg">
            <button class="copy-btn" onclick="copyCode('mcp-agg')">COPY</button>
            <pre><span class="c"># servers/aggregation_mcp.py ‚Äî run separately:  python -m servers.aggregation_mcp</span>
<span class="k">from</span> <span class="n">mcp.server.fastmcp</span> <span class="k">import</span> <span class="n">FastMCP</span>
<span class="k">from</span> <span class="n">config.db</span> <span class="k">import</span> <span class="n">get_pool</span>
<span class="k">import</span> <span class="n">anthropic</span>, <span class="n">json</span>

mcp = <span class="n">FastMCP</span>(<span class="s">"aggregation_mcp"</span>)

<span class="k">@mcp.tool</span>()
<span class="k">async def</span> <span class="n">aggregate_intel</span>(all_results: <span class="b">dict</span>, run_id: <span class="b">str</span>) -> <span class="b">dict</span>:
    client = anthropic.Anthropic()
    msg = client.messages.create(model=<span class="s">"claude-sonnet-4-6"</span>, max_tokens=<span class="v">4000</span>,
        system=AGGREGATOR_PROMPT,
        messages=[{<span class="s">"role"</span>:<span class="s">"user"</span>,<span class="s">"content"</span>:json.dumps(all_results)}])
    report = json.loads(msg.content[<span class="v">0</span>].text)
    pool = <span class="k">await</span> get_pool()
    <span class="k">async with</span> pool.acquire() <span class="k">as</span> conn:
        <span class="k">await</span> conn.execute(<span class="s">"""
            INSERT INTO pipeline_runs (run_id, brief, dashboard_cards, created_at)
            VALUES ($1,$2,$3,NOW())
        """</span>, run_id, report[<span class="s">"brief"</span>], json.dumps(report[<span class="s">"dashboard_cards"</span>]))
    <span class="k">return</span> report

<span class="k">if</span> __name__ == <span class="s">"__main__"</span>:
    mcp.run(transport=<span class="s">"sse"</span>, port=<span class="v">6005</span>)  <span class="c"># ‚Üí http://localhost:6005/sse</span></pre>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- TASK B ‚Äî 08: DATABASE SCHEMA & CONNECTIONS                -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="section-title">08 ‚Äî Database Schema &amp; Connection Layer</div>
    <div class="task-banner task-b">
        <span class="task-tag">TASK B</span>
        <span>Create PostgreSQL <code
                style="background:rgba(255,255,255,0.1);padding:2px 6px;border-radius:3px;font-size:11px;font-family:monospace;">intelligence_db</code>
            with 6 tables. Shared <code
                style="background:rgba(255,255,255,0.1);padding:2px 6px;border-radius:3px;font-size:11px;font-family:monospace;">asyncpg</code>
            pool imported by all MCP servers. Run migrations via SQL file on first boot.</span>
    </div>

    <div class="db-schema-grid">
        <div class="db-table">
            <div class="db-table-header">üìã pipeline_runs</div>
            <div class="db-col"><span class="db-pk">PK</span> run_id UUID</div>
            <div class="db-col"><span class="db-col-type">text</span> brief</div>
            <div class="db-col"><span class="db-col-type">jsonb</span> dashboard_cards[]</div>
            <div class="db-col"><span class="db-col-type">jsonb</span> cross_links[]</div>
            <div class="db-col"><span class="db-col-type">jsonb</span> timeline[]</div>
            <div class="db-col"><span class="db-col-type">int</span> total_sources</div>
            <div class="db-col"><span class="db-col-type">ts</span> created_at</div>
        </div>
        <div class="db-table">
            <div class="db-table-header">üì∞ sources</div>
            <div class="db-col"><span class="db-pk">PK</span> source_id VARCHAR(64)</div>
            <div class="db-col"><span class="db-fk">FK</span> run_id ‚Üí pipeline_runs</div>
            <div class="db-col"><span class="db-col-type">enum</span> type (youtube|pdf|web|zip)</div>
            <div class="db-col"><span class="db-col-type">text</span> title</div>
            <div class="db-col"><span class="db-col-type">text</span> body_text</div>
            <div class="db-col"><span class="db-col-type">text</span> source_url</div>
            <div class="db-col"><span class="db-col-type">ts</span> ingested_at</div>
        </div>
        <div class="db-table">
            <div class="db-table-header">üè∑ entities</div>
            <div class="db-col"><span class="db-pk">PK</span> entity_id SERIAL</div>
            <div class="db-col"><span class="db-fk">FK</span> source_id ‚Üí sources</div>
            <div class="db-col"><span class="db-col-type">enum</span> type (person|org|location|date)</div>
            <div class="db-col"><span class="db-col-type">text</span> name</div>
            <div class="db-col"><span class="db-col-type">int</span> mention_count</div>
        </div>
        <div class="db-table">
            <div class="db-table-header">üìä analysis_results</div>
            <div class="db-col"><span class="db-pk">PK</span> analysis_id SERIAL</div>
            <div class="db-col"><span class="db-fk">FK</span> source_id ‚Üí sources</div>
            <div class="db-col"><span class="db-col-type">float</span> sentiment (‚àí1 to +1)</div>
            <div class="db-col"><span class="db-col-type">jsonb</span> tags[]</div>
            <div class="db-col"><span class="db-col-type">text</span> framing</div>
            <div class="db-col"><span class="db-col-type">text</span> language, region</div>
        </div>
        <div class="db-table">
            <div class="db-table-header">üéô transcripts</div>
            <div class="db-col"><span class="db-pk">PK</span> transcript_id SERIAL</div>
            <div class="db-col"><span class="db-fk">FK</span> source_id ‚Üí sources</div>
            <div class="db-col"><span class="db-col-type">text</span> transcript_clean</div>
            <div class="db-col"><span class="db-col-type">jsonb</span> key_quotes[]</div>
            <div class="db-col"><span class="db-col-type">int</span> duration_seconds</div>
            <div class="db-col"><span class="db-col-type">text</span> language</div>
        </div>
        <div class="db-table">
            <div class="db-table-header">üì§ dashboard_cards</div>
            <div class="db-col"><span class="db-pk">PK</span> card_id VARCHAR(32)</div>
            <div class="db-col"><span class="db-fk">FK</span> run_id ‚Üí pipeline_runs</div>
            <div class="db-col"><span class="db-col-type">text</span> headline, summary</div>
            <div class="db-col"><span class="db-col-type">float</span> sentiment</div>
            <div class="db-col"><span class="db-col-type">jsonb</span> tags[], sources[]</div>
            <div class="db-col"><span class="db-col-type">ts</span> timestamp</div>
        </div>
    </div>

    <div class="code-section" style="margin-bottom:48px;">
        <div class="tabs">
            <button class="tab active" onclick="showTab('db-pool',this)">DB Pool (asyncpg)</button>
            <button class="tab" onclick="showTab('db-sql',this)">CREATE TABLES SQL</button>
            <button class="tab" onclick="showTab('db-env',this)">.env Config</button>
        </div>
        <div class="code-block active" id="db-pool">
            <button class="copy-btn" onclick="copyCode('db-pool')">COPY</button>
            <pre><span class="c"># config/db.py ‚Äî shared asyncpg pool used by all MCP servers + FastAPI</span>
<span class="k">import</span> <span class="n">asyncpg</span>, <span class="n">os</span>

_pool = <span class="k">None</span>

<span class="k">async def</span> <span class="n">get_pool</span>() -> asyncpg.Pool:
    <span class="k">global</span> _pool
    <span class="k">if</span> _pool <span class="k">is None</span>:
        _pool = <span class="k">await</span> asyncpg.create_pool(
            dsn=os.getenv(<span class="s">"DATABASE_URL"</span>),
            min_size=<span class="v">2</span>,
            max_size=<span class="v">10</span>,
            command_timeout=<span class="v">30</span>
        )
    <span class="k">return</span> _pool

<span class="k">async def</span> <span class="n">close_pool</span>():
    <span class="k">global</span> _pool
    <span class="k">if</span> _pool: <span class="k">await</span> _pool.close(); _pool = <span class="k">None</span>

<span class="k">async def</span> <span class="n">save_source</span>(run_id, source_id, src_type, title, body, url=<span class="k">None</span>):
    pool = <span class="k">await</span> get_pool()
    <span class="k">async with</span> pool.acquire() <span class="k">as</span> conn:
        <span class="k">await</span> conn.execute(<span class="s">"""
            INSERT INTO sources (source_id, run_id, type, title, body_text, source_url, ingested_at)
            VALUES ($1,$2,$3,$4,$5,$6,NOW())
            ON CONFLICT (source_id) DO NOTHING
        """</span>, source_id, run_id, src_type, title, body, url)

<span class="k">async def</span> <span class="n">run_migrations</span>():
    pool = <span class="k">await</span> get_pool()
    <span class="k">async with</span> pool.acquire() <span class="k">as</span> conn:
        <span class="k">with</span> <span class="b">open</span>(<span class="s">"migrations/001_create_tables.sql"</span>) <span class="k">as</span> f:
            <span class="k">await</span> conn.execute(f.read())</pre>
        </div>
        <div class="code-block" id="db-sql">
            <button class="copy-btn" onclick="copyCode('db-sql')">COPY</button>
            <pre><span class="c">-- migrations/001_create_tables.sql</span>
<span class="k">CREATE EXTENSION IF NOT EXISTS</span> <span class="s">"uuid-ossp"</span>;

<span class="k">CREATE TABLE IF NOT EXISTS</span> pipeline_runs (
    run_id          UUID <span class="k">PRIMARY KEY DEFAULT</span> uuid_generate_v4(),
    brief           <span class="b">TEXT</span>,
    dashboard_cards <span class="b">JSONB</span>,
    cross_links     <span class="b">JSONB</span>,
    timeline        <span class="b">JSONB</span>,
    total_sources   <span class="b">INT DEFAULT</span> <span class="v">0</span>,
    created_at      <span class="b">TIMESTAMPTZ DEFAULT NOW</span>()
);
<span class="k">CREATE TABLE IF NOT EXISTS</span> sources (
    source_id   <span class="b">VARCHAR</span>(64) <span class="k">PRIMARY KEY</span>,
    run_id      UUID <span class="k">REFERENCES</span> pipeline_runs(run_id) <span class="k">ON DELETE CASCADE</span>,
    type        <span class="b">VARCHAR</span>(16),
    title       <span class="b">TEXT</span>,
    body_text   <span class="b">TEXT</span>,
    source_url  <span class="b">TEXT</span>,
    ingested_at <span class="b">TIMESTAMPTZ DEFAULT NOW</span>()
);
<span class="k">CREATE TABLE IF NOT EXISTS</span> entities (
    entity_id     <span class="b">SERIAL PRIMARY KEY</span>,
    source_id     <span class="b">VARCHAR</span>(64) <span class="k">REFERENCES</span> sources(source_id),
    type          <span class="b">VARCHAR</span>(16),
    name          <span class="b">TEXT</span>,
    mention_count <span class="b">INT DEFAULT</span> <span class="v">1</span>
);
<span class="k">CREATE TABLE IF NOT EXISTS</span> analysis_results (
    analysis_id <span class="b">SERIAL PRIMARY KEY</span>,
    source_id   <span class="b">VARCHAR</span>(64) <span class="k">REFERENCES</span> sources(source_id),
    sentiment   <span class="b">FLOAT</span>,
    tags        <span class="b">JSONB</span>,
    framing     <span class="b">VARCHAR</span>(32),
    language    <span class="b">VARCHAR</span>(8),
    region      <span class="b">TEXT</span>
);
<span class="k">CREATE TABLE IF NOT EXISTS</span> transcripts (
    transcript_id    <span class="b">SERIAL PRIMARY KEY</span>,
    source_id        <span class="b">VARCHAR</span>(64) <span class="k">REFERENCES</span> sources(source_id),
    transcript_clean <span class="b">TEXT</span>,
    key_quotes       <span class="b">JSONB</span>,
    duration_seconds <span class="b">INT</span>,
    language         <span class="b">VARCHAR</span>(8)
);
<span class="k">CREATE TABLE IF NOT EXISTS</span> dashboard_cards (
    card_id   <span class="b">VARCHAR</span>(32) <span class="k">PRIMARY KEY</span>,
    run_id    UUID <span class="k">REFERENCES</span> pipeline_runs(run_id),
    headline  <span class="b">TEXT</span>,
    summary   <span class="b">TEXT</span>,
    sentiment <span class="b">FLOAT</span>,
    tags      <span class="b">JSONB</span>,
    sources   <span class="b">JSONB</span>,
    timestamp <span class="b">TIMESTAMPTZ DEFAULT NOW</span>()
);
<span class="k">CREATE INDEX IF NOT EXISTS ON</span> sources(run_id);
<span class="k">CREATE INDEX IF NOT EXISTS ON</span> entities(source_id);
<span class="k">CREATE INDEX IF NOT EXISTS ON</span> analysis_results(source_id);</pre>
        </div>
        <div class="code-block" id="db-env">
            <button class="copy-btn" onclick="copyCode('db-env')">COPY</button>
            <pre><span class="c"># .env ‚Äî copy to project root, never commit to git</span>

<span class="c"># ‚îÄ‚îÄ PostgreSQL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
DATABASE_URL=<span class="s">postgresql://postgres:password@localhost:5432/intelligence_db</span>

<span class="c"># ‚îÄ‚îÄ Anthropic ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
ANTHROPIC_API_KEY=<span class="s">sk-ant-api03-...</span>

<span class="c"># ‚îÄ‚îÄ FastAPI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
BACKEND_PORT=<span class="v">8000</span>
CORS_ORIGINS=<span class="s">http://localhost:5173,http://localhost:3000</span>

<span class="c"># ‚îÄ‚îÄ MCP Server Ports ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
MEDIA_MCP_PORT=<span class="v">6001</span>
DOCUMENT_MCP_PORT=<span class="v">6002</span>
WEB_MCP_PORT=<span class="v">6003</span>
ANALYSIS_MCP_PORT=<span class="v">6004</span>
AGG_MCP_PORT=<span class="v">6005</span>

<span class="c"># ‚îÄ‚îÄ File Storage ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
UPLOAD_DIR=<span class="s">/tmp/intel_uploads</span>
MAX_UPLOAD_MB=<span class="v">200</span></pre>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- TASK C ‚Äî 09: BACKEND ‚Üî EXISTING REACT FRONTEND           -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="section-title">09 ‚Äî Backend ‚Üî Existing React Frontend Wiring</div>
    <div class="task-banner task-c">
        <span class="task-tag">TASK C</span>
        <span>Wire FastAPI to the existing React app (extracted from ZIP). Serve React static build from <code
                style="background:rgba(255,255,255,0.1);padding:2px 6px;border-radius:3px;font-size:11px;font-family:monospace;">dashboard/dist/</code>.
            React connects via <code
                style="background:rgba(255,255,255,0.1);padding:2px 6px;border-radius:3px;font-size:11px;font-family:monospace;">useIntelFeed</code>
            WebSocket hook to stream live intelligence cards in real time.</span>
    </div>

    <table class="cost-table" style="margin-bottom:32px;">
        <thead>
            <tr>
                <th>Method</th>
                <th>Endpoint</th>
                <th>Purpose</th>
                <th>React Component</th>
                <th>Response Shape</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><span class="badge-pill pill-a">POST</span></td>
                <td class="mono">/api/run</td>
                <td>Submit pipeline run (multipart: ZIP + PDFs + URL list)</td>
                <td>UploadForm</td>
                <td class="mono">{ run_id }</td>
            </tr>
            <tr>
                <td><span class="badge-pill pill-t">GET</span></td>
                <td class="mono">/api/runs</td>
                <td>List all previous runs</td>
                <td>RunHistory sidebar</td>
                <td class="mono">[{ run_id, created_at, total_sources }]</td>
            </tr>
            <tr>
                <td><span class="badge-pill pill-t">GET</span></td>
                <td class="mono">/api/runs/{run_id}</td>
                <td>Fetch full report (cards, brief, timeline)</td>
                <td>Dashboard page</td>
                <td class="mono">{ brief, cards[], timeline[] }</td>
            </tr>
            <tr>
                <td><span class="badge-pill pill-p">WS</span></td>
                <td class="mono">/ws/{run_id}</td>
                <td>Stream live agent progress events</td>
                <td>LiveFeed component</td>
                <td class="mono">{ event, agent, data, timestamp }</td>
            </tr>
            <tr>
                <td><span class="badge-pill pill-t">GET</span></td>
                <td class="mono">/api/sources/{run_id}</td>
                <td>List all sources ingested</td>
                <td>SourcesTable</td>
                <td class="mono">[{ source_id, type, title, url }]</td>
            </tr>
            <tr>
                <td><span class="badge-pill pill-r">DEL</span></td>
                <td class="mono">/api/runs/{run_id}</td>
                <td>Delete run + all DB records</td>
                <td>RunHistory delete btn</td>
                <td class="mono">{ deleted: true }</td>
            </tr>
        </tbody>
    </table>

    <div class="code-section" style="margin-bottom:48px;">
        <div class="tabs">
            <button class="tab active" onclick="showTab('fe-main',this)">FastAPI main.py</button>
            <button class="tab" onclick="showTab('fe-ws',this)">WebSocket Route</button>
            <button class="tab" onclick="showTab('fe-hook',this)">React useIntelFeed</button>
            <button class="tab" onclick="showTab('fe-upload',this)">React UploadForm</button>
            <button class="tab" onclick="showTab('fe-vite',this)">Vite Proxy Config</button>
        </div>
        <div class="code-block active" id="fe-main">
            <button class="copy-btn" onclick="copyCode('fe-main')">COPY</button>
            <pre><span class="c"># main.py ‚Äî FastAPI entry point: CORS + lifespan (DB + MCP) + static React</span>
<span class="k">from</span> <span class="n">fastapi</span> <span class="k">import</span> <span class="n">FastAPI</span>
<span class="k">from</span> <span class="n">fastapi.middleware.cors</span> <span class="k">import</span> <span class="n">CORSMiddleware</span>
<span class="k">from</span> <span class="n">fastapi.staticfiles</span> <span class="k">import</span> <span class="n">StaticFiles</span>
<span class="k">from</span> <span class="n">contextlib</span> <span class="k">import</span> <span class="n">asynccontextmanager</span>
<span class="k">from</span> <span class="n">config.db</span> <span class="k">import</span> <span class="n">get_pool</span>, <span class="n">close_pool</span>, <span class="n">run_migrations</span>
<span class="k">from</span> <span class="n">config.mcp_registry</span> <span class="k">import</span> <span class="n">connect_all</span>
<span class="k">import</span> <span class="n">os</span>

<span class="k">@asynccontextmanager</span>
<span class="k">async def</span> <span class="n">lifespan</span>(app: <span class="n">FastAPI</span>):
    <span class="k">await</span> run_migrations()          <span class="c"># auto-create DB tables on first boot</span>
    app.state.mcp = <span class="k">await</span> connect_all()  <span class="c"># connect all 5 MCP servers</span>
    <span class="k">yield</span>
    <span class="k">await</span> close_pool()

app = <span class="n">FastAPI</span>(lifespan=lifespan)

app.add_middleware(CORSMiddleware,
    allow_origins=os.getenv(<span class="s">"CORS_ORIGINS"</span>,<span class="s">"*"</span>).split(<span class="s">","</span>),
    allow_credentials=<span class="k">True</span>, allow_methods=[<span class="s">"*"</span>], allow_headers=[<span class="s">"*"</span>])

<span class="k">from</span> <span class="n">api.routes</span> <span class="k">import</span> <span class="n">pipeline</span>
app.include_router(pipeline.router, prefix=<span class="s">"/api"</span>)

<span class="c"># Serve existing React app from dashboard/dist/ at root /</span>
app.mount(<span class="s">"/"</span>, StaticFiles(directory=<span class="s">"dashboard/dist"</span>, html=<span class="k">True</span>), name=<span class="s">"react"</span>)</pre>
        </div>
        <div class="code-block" id="fe-ws">
            <button class="copy-btn" onclick="copyCode('fe-ws')">COPY</button>
            <pre><span class="c"># api/routes/pipeline.py ‚Äî WebSocket endpoint for live agent event streaming</span>
<span class="k">from</span> <span class="n">fastapi</span> <span class="k">import</span> <span class="n">APIRouter</span>, <span class="n">WebSocket</span>, <span class="n">WebSocketDisconnect</span>, <span class="n">UploadFile</span>
<span class="k">import</span> <span class="n">asyncio</span>, <span class="n">uuid</span>, <span class="n">json</span>

router = <span class="n">APIRouter</span>()
_queues: <span class="b">dict</span>[<span class="b">str</span>, asyncio.Queue] = {}

<span class="k">@router.post</span>(<span class="s">"/run"</span>)
<span class="k">async def</span> <span class="n">submit_run</span>(files: <span class="b">list</span>[UploadFile], urls: <span class="b">str</span> = <span class="s">""</span>):
    run_id = <span class="b">str</span>(uuid.uuid4())
    q = asyncio.Queue()
    _queues[run_id] = q
    asyncio.create_task(run_pipeline(run_id, files, urls, q))
    <span class="k">return</span> {<span class="s">"run_id"</span>: run_id}

<span class="k">@router.websocket</span>(<span class="s">"/ws/{run_id}"</span>)
<span class="k">async def</span> <span class="n">ws_stream</span>(ws: WebSocket, run_id: <span class="b">str</span>):
    <span class="k">await</span> ws.accept()
    q = _queues.get(run_id)
    <span class="k">if not</span> q:
        <span class="k">await</span> ws.send_json({<span class="s">"error"</span>:<span class="s">"run not found"</span>}); <span class="k">return</span>
    <span class="k">try</span>:
        <span class="k">while True</span>:
            event = <span class="k">await</span> q.get()
            <span class="k">await</span> ws.send_json(event)
            <span class="k">if</span> event.get(<span class="s">"event"</span>) == <span class="s">"DONE"</span>: <span class="k">break</span>
    <span class="k">except</span> WebSocketDisconnect: <span class="b">pass</span>
    <span class="k">finally</span>: _queues.pop(run_id, <span class="k">None</span>)</pre>
        </div>
        <div class="code-block" id="fe-hook">
            <button class="copy-btn" onclick="copyCode('fe-hook')">COPY</button>
            <pre><span class="c">// src/hooks/useIntelFeed.ts ‚Äî React hook: opens WS, streams live events</span>
<span class="k">import</span> { useState, useEffect } <span class="k">from</span> <span class="s">'react'</span>;

<span class="k">interface</span> <span class="n">IntelEvent</span> {
    event: <span class="b">string</span>;
    agent: <span class="b">string</span>;
    data: <span class="n">Record</span>&lt;<span class="b">string</span>, <span class="n">unknown</span>&gt;;
    timestamp: <span class="b">string</span>;
}

<span class="k">export function</span> <span class="n">useIntelFeed</span>(runId: <span class="b">string</span> | <span class="k">null</span>) {
    <span class="k">const</span> [events, setEvents] = useState&lt;<span class="n">IntelEvent</span>[]&gt;([]);
    <span class="k">const</span> [status, setStatus] = useState&lt;<span class="s">'idle'</span>|<span class="s">'connecting'</span>|<span class="s">'live'</span>|<span class="s">'done'</span>&gt;(<span class="s">'idle'</span>);

    useEffect(() =&gt; {
        <span class="k">if</span> (!runId) <span class="k">return</span>;
        setStatus(<span class="s">'connecting'</span>);
        <span class="k">const</span> ws = <span class="k">new</span> WebSocket(<span class="s">`ws://localhost:8000/ws/${runId}`</span>);
        ws.onopen = () =&gt; setStatus(<span class="s">'live'</span>);
        ws.onmessage = ({ data }) =&gt; {
            <span class="k">const</span> ev: <span class="n">IntelEvent</span> = JSON.parse(data);
            setEvents(prev =&gt; [...prev, ev]);
            <span class="k">if</span> (ev.event === <span class="s">'DONE'</span>) setStatus(<span class="s">'done'</span>);
        };
        ws.onclose = () =&gt; setStatus(<span class="s">'done'</span>);
        <span class="k">return</span> () =&gt; ws.close();
    }, [runId]);

    <span class="k">return</span> { events, status };
}</pre>
        </div>
        <div class="code-block" id="fe-upload">
            <button class="copy-btn" onclick="copyCode('fe-upload')">COPY</button>
            <pre><span class="c">// src/components/UploadForm.tsx ‚Äî file upload ‚Üí gets run_id ‚Üí opens WS</span>
<span class="k">import</span> { useState } <span class="k">from</span> <span class="s">'react'</span>;
<span class="k">import</span> { useIntelFeed } <span class="k">from</span> <span class="s">'../hooks/useIntelFeed'</span>;

<span class="k">export function</span> <span class="n">UploadForm</span>() {
    <span class="k">const</span> [runId, setRunId] = useState&lt;<span class="b">string</span> | <span class="k">null</span>&gt;(<span class="k">null</span>);
    <span class="k">const</span> { events, status } = useIntelFeed(runId);

    <span class="k">async function</span> <span class="n">handleSubmit</span>(e: React.FormEvent&lt;HTMLFormElement&gt;) {
        e.preventDefault();
        <span class="k">const</span> form = <span class="k">new</span> FormData(e.currentTarget);
        <span class="k">const</span> res = <span class="k">await</span> fetch(<span class="s">'/api/run'</span>, { method: <span class="s">'POST'</span>, body: form });
        <span class="k">const</span> { run_id } = <span class="k">await</span> res.json();
        setRunId(run_id);  <span class="c">// triggers WS hook automatically</span>
    }

    <span class="k">return</span> (
        &lt;form onSubmit={handleSubmit} encType=<span class="s">"multipart/form-data"</span>&gt;
            &lt;input type=<span class="s">"file"</span> name=<span class="s">"files"</span> multiple accept=<span class="s">".pdf,.zip"</span> /&gt;
            &lt;input type=<span class="s">"text"</span> name=<span class="s">"urls"</span> placeholder=<span class="s">"YouTube URLs (comma separated)"</span> /&gt;
            &lt;button type=<span class="s">"submit"</span>&gt;‚ñ∂ Run Intelligence Pipeline&lt;/button&gt;
            &lt;p&gt;Status: {status} ¬∑ Events: {events.length}&lt;/p&gt;
        &lt;/form&gt;
    );
}</pre>
        </div>
        <div class="code-block" id="fe-vite">
            <button class="copy-btn" onclick="copyCode('fe-vite')">COPY</button>
            <pre><span class="c">// vite.config.ts ‚Äî proxy /api + /ws to FastAPI :8000 during local dev</span>
<span class="k">import</span> { defineConfig } <span class="k">from</span> <span class="s">'vite'</span>;
<span class="k">import</span> react <span class="k">from</span> <span class="s">'@vitejs/plugin-react'</span>;

<span class="k">export default</span> defineConfig({
    plugins: [react()],
    server: {
        port: <span class="v">5173</span>,
        proxy: {
            <span class="s">'/api'</span>: { target: <span class="s">'http://localhost:8000'</span>, changeOrigin: <span class="k">true</span> },
            <span class="s">'/ws'</span>:  { target: <span class="s">'ws://localhost:8000'</span>, ws: <span class="k">true</span>, changeOrigin: <span class="k">true</span> }
        }
    }
});

<span class="c">// Production: FastAPI serves React from dashboard/dist/ via StaticFiles mount</span>
<span class="c">// Build React: cd dashboard && npm run build ‚Üí outputs to dist/</span>
<span class="c">// Run all: uvicorn main:app --port 8000 (+ 5 MCP servers per registry)</span></pre>
        </div>
    </div>

    <!-- FOOTER -->
    <div class="footer">
        <div class="footer-left">LIVINGAI TEAM ¬∑ MEDIA INTELLIGENCE PLATFORM ¬∑ FEB 22 AGENT PLAN</div>
        <div class="footer-right">
            <span class="live-dot"></span>
            TEAM B: AMEY ¬∑ SAIRAJ ¬∑ CHANDRESH
        </div>
    </div>

    </div><!-- /container -->

    <!-- Theme Toggle -->
    <button id="theme-toggle" title="Toggle theme" aria-label="Toggle theme">üåô</button>

    <script>
        function showTab(id, btn) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.code-block').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
        }
        function copyCode(id) {
            const pre = document.getElementById(id).querySelector('pre');
            navigator.clipboard.writeText(pre.innerText).then(() => {
                const btn = document.getElementById(id).querySelector('.copy-btn');
                btn.textContent = 'COPIED!'; btn.style.color = '#4fffd4';
                setTimeout(() => { btn.textContent = 'COPY'; btn.style.color = ''; }, 2000);
            });
        }
        (function () {
            var btn = document.getElementById('theme-toggle');
            var theme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            function apply(t) {
                document.documentElement.setAttribute('data-theme', t);
                btn.textContent = t === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                localStorage.setItem('theme', t);
            }
            apply(theme);
            btn.addEventListener('click', () => apply(document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'));
        })();
    </script>

</body>

</html>